INFO:     Will watch for changes in these directories: ['/Users/enrico/workspace/translator']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [96826] using WatchFiles
2025-12-29 20:39:59 - src.translator.api - INFO - Logging initialized. Log file: /Users/enrico/workspace/translator/logs/backend.log
INFO:     Started server process [96829]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
2025-12-29 20:40:01 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:40:01 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:40:01 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:59786 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 20:40:01 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:40:01 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:40:01 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:59787 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 20:40:10 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:40:10 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:40:10 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:59799 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 20:40:10 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:40:10 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:40:10 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:59800 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 20:40:15 - src.translator.api - INFO - Detected language: fr (prob: 1.00) -> fr
INFO:     127.0.0.1:59808 - "POST /api/detect-language HTTP/1.1" 200 OK
2025-12-29 20:41:15 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:41:15 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:41:15 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:59862 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 20:41:39 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:41:39 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:41:39 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:59877 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 20:42:20 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:42:20 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:42:20 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:59914 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 20:51:27 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:51:27 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:51:27 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60252 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 20:51:27 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:51:27 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:51:27 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60253 - "GET /api/prompt HTTP/1.1" 200 OK
INFO:     127.0.0.1:60257 - "GET /api/user-role HTTP/1.1" 200 OK
2025-12-29 20:51:40 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:51:40 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:51:40 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60259 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 20:51:40 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:51:40 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:51:40 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60261 - "GET /api/prompt HTTP/1.1" 200 OK
INFO:     127.0.0.1:60264 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
INFO:     127.0.0.1:60266 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
2025-12-29 20:52:20 - src.translator.api - INFO - Detected language: fr (prob: 1.00) -> fr
INFO:     127.0.0.1:60276 - "POST /api/detect-language HTTP/1.1" 200 OK
2025-12-29 20:52:23 - src.translator.api - INFO - ================================================================================
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] ===== NEW TRANSLATION REQUEST =====
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] Timestamp: 1767037943.076942
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] File name: OBJET DU BAIL4.txt
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] Source: fr -> Target: it
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] File size: 129 bytes
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] First 200 bytes: b"\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse de l'immeuble: [\xc3\x80 compl\xc3\xa9ter]"
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] Use glossary: True
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] Using default glossary: glossary/glossary.csv
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] Generated job_id: bb100b95-3e58-48c3-ae71-3eb17e4a973d
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: Created isolated input file: input_bb100b95-3e58-48c3-ae71-3eb17e4a973d_61zn4_08.txt
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: File hash: 6c27678b16998564...
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] Job bb100b95-3e58-48c3-ae71-3eb17e4a973d stored in translation_jobs
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] Total active jobs: 1
2025-12-29 20:52:23 - src.translator.api - INFO - ================================================================================
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: Translation thread started
2025-12-29 20:52:23 - src.translator.api - INFO - [TRANSLATION bb100b95-3e58-48c3-ae71-3eb17e4a973d] ===== STARTING TRANSLATION THREAD =====
2025-12-29 20:52:23 - src.translator.api - INFO - [REQUEST c0420f01] ===== REQUEST PROCESSING COMPLETE =====
2025-12-29 20:52:23 - src.translator.api - INFO - [TRANSLATION bb100b95-3e58-48c3-ae71-3eb17e4a973d] Job data from storage:
2025-12-29 20:52:23 - src.translator.api - INFO - ================================================================================
2025-12-29 20:52:23 - src.translator.api - INFO - [TRANSLATION bb100b95-3e58-48c3-ae71-3eb17e4a973d]   - File hash: 6c27678b169985646fa3b971e35c8042
INFO:     127.0.0.1:60279 - "POST /api/translate HTTP/1.1" 202 Accepted
2025-12-29 20:52:23 - src.translator.api - INFO - [TRANSLATION bb100b95-3e58-48c3-ae71-3eb17e4a973d]   - Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_bb100b95-3e58-48c3-ae71-3eb17e4a973d_61zn4_08.txt
2025-12-29 20:52:23 - src.translator.api - INFO - [TRANSLATION bb100b95-3e58-48c3-ae71-3eb17e4a973d]   - Source: fr -> Target: it
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [FILE VERIFICATION] Opening file: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_bb100b95-3e58-48c3-ae71-3eb17e4a973d_61zn4_08.txt
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [FILE VERIFICATION] File absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_bb100b95-3e58-48c3-ae71-3eb17e4a973d_61zn4_08.txt
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [FILE VERIFICATION] File exists: True
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [FILE VERIFICATION] Read 129 bytes from file
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [FILE VERIFICATION] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [FILE VERIFICATION] Actual hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [FILE VERIFICATION] First 100 bytes: b'\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse d'
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [FILE VERIFICATION] Hash verified successfully
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [FILE VERIFICATION] File: input_bb100b95-3e58-48c3-ae71-3eb17e4a973d_61zn4_08.txt, Size: 129 bytes
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: Created isolated temp directory: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/translation_bb100b95-3e58-48c3-ae71-3eb17e4a973d_8f5wgbuf
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: Loading glossary from glossary/glossary.csv (file will be read fresh)
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: Loaded glossary 'glossary' with 1350 entries
INFO:     127.0.0.1:60281 - "GET /api/translate/bb100b95-3e58-48c3-ae71-3eb17e4a973d/status HTTP/1.1" 200 OK
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: Using shared translation memory from /Users/enrico/workspace/translator/data/memory.json
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: Memory contains 202 existing records
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: Using custom prompt provided by user
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [PRE-TRANSLATE] About to call translate_file_to_memory
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [PRE-TRANSLATE] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_bb100b95-3e58-48c3-ae71-3eb17e4a973d_61zn4_08.txt
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [PRE-TRANSLATE] Input path absolute: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_bb100b95-3e58-48c3-ae71-3eb17e4a973d_61zn4_08.txt
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [PRE-TRANSLATE] Input file exists: True
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [PRE-TRANSLATE] Final verification - Hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [PRE-TRANSLATE] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [PRE-TRANSLATE] File verified, calling translate_file_to_memory
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: [PRE-TRANSLATE] Source lang: fr, Target lang: it
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: Stored 3 original paragraphs
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] ===== STARTING SINGLE-SHOT TRANSLATION =====
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_bb100b95-3e58-48c3-ae71-3eb17e4a973d_61zn4_08.txt
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_bb100b95-3e58-48c3-ae71-3eb17e4a973d_61zn4_08.txt
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] File size: 129 bytes
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Reading entire file as text...
2025-12-29 20:52:23 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_bb100b95-3e58-48c3-ae71-3eb17e4a973d_61zn4_08.txt
2025-12-29 20:52:23 - src.translator.processing - INFO - [_read_file_as_text] File type: .txt
2025-12-29 20:52:23 - src.translator.processing - INFO - [_read_file_as_text] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:23 - src.translator.processing - INFO - [_read_file_as_text] File size: 129 bytes
2025-12-29 20:52:23 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 121 characters
2025-12-29 20:52:23 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces  
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À compléter]...
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Looking up glossary matches...
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Found 0 glossary matches (after filtering reference doc conflicts)
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 1: CHECKING TRANSLATION MEMORY =====
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Memory enabled (skip_memory=False), checking for existing translation...
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Document length: 121 characters
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Found memory match with similarity: 100.0%
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Memory source preview: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces au ___ étage
☐ Maison de ______ pièces
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À co...
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Memory translation preview: # TRADUZIONE

## 2. OGGETTO DELLA LOCAZIONE

☐ Sgabuzzino di ______ locali al ___ piano
☐ Casa di ______ locali
☐ ______ camera/e ammobiliata/e

Indir...
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] ✅ STEP 1 RESULT: Using translation from memory (similarity: 100.0%)
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] ✅ No Claude API call needed - translation retrieved from memory
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 2: SKIPPED (using memory translation) =====
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] No Claude API call needed - translation retrieved from memory
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 3: SKIPPED (translation already in memory) =====
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Translation already exists in memory, no need to store again
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Translation complete: 0.10s
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Translated length: 4,128 characters
2025-12-29 20:52:23 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applying glossary: glossary
2025-12-29 20:52:23 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Translated text length: 4128
2025-12-29 20:52:23 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applied 5 glossary terms
2025-12-29 20:52:23 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Breakdown: 4 translation matches, 1 source replacements
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Glossary enrichment: 5 terms highlighted (after filtering reference doc)
2025-12-29 20:52:23 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Applying translation memory
2025-12-29 20:52:23 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Translated text length: 4235
2025-12-29 20:52:23 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Found 15 memory records for fr->it
2025-12-29 20:52:23 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Applied 0 memory terms
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Memory enrichment: 0 terms highlighted
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] Generating PDF from 3 source paragraphs and 18 translated paragraphs
2025-12-29 20:52:23 - src.translator.pdf_writer - INFO - [write_pdf_to_bytes] Creating two-column layout with 3 source paragraphs and 18 translated paragraphs
2025-12-29 20:52:23 - src.translator.processing - INFO - [translate_file_to_memory] PDF generated: 6,732 bytes
2025-12-29 20:52:23 - src.translator.api - INFO - [TRANSLATION bb100b95-3e58-48c3-ae71-3eb17e4a973d] Translation complete
2025-12-29 20:52:23 - src.translator.api - INFO - [TRANSLATION bb100b95-3e58-48c3-ae71-3eb17e4a973d] PDF generated in memory: 6,732 bytes
2025-12-29 20:52:23 - src.translator.api - INFO - [TRANSLATION bb100b95-3e58-48c3-ae71-3eb17e4a973d] Original paragraphs: 3
2025-12-29 20:52:23 - src.translator.api - INFO - [TRANSLATION bb100b95-3e58-48c3-ae71-3eb17e4a973d] Translated paragraphs: 18
2025-12-29 20:52:23 - src.translator.api - INFO - [TRANSLATION bb100b95-3e58-48c3-ae71-3eb17e4a973d] Status updated to completed
2025-12-29 20:52:23 - src.translator.api - INFO - [TRANSLATION bb100b95-3e58-48c3-ae71-3eb17e4a973d] Final job hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:23 - src.translator.api - INFO - [TRANSLATION bb100b95-3e58-48c3-ae71-3eb17e4a973d] ===== TRANSLATION COMPLETE =====
2025-12-29 20:52:23 - src.translator.api - INFO - ================================================================================
2025-12-29 20:52:23 - src.translator.api - INFO - Job bb100b95-3e58-48c3-ae71-3eb17e4a973d: Cleaned up input file
INFO:     127.0.0.1:60283 - "GET /api/translate/bb100b95-3e58-48c3-ae71-3eb17e4a973d/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60285 - "GET /api/translate/bb100b95-3e58-48c3-ae71-3eb17e4a973d/report HTTP/1.1" 200 OK
2025-12-29 20:52:45 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:52:45 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:52:45 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60292 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 20:52:45 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 20:52:45 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 20:52:45 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60294 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 20:52:51 - src.translator.api - INFO - Detected language: fr (prob: 1.00) -> fr
INFO:     127.0.0.1:60296 - "POST /api/detect-language HTTP/1.1" 200 OK
2025-12-29 20:52:54 - src.translator.api - INFO - ================================================================================
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] ===== NEW TRANSLATION REQUEST =====
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] Timestamp: 1767037974.573521
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] File name: OBJET DU BAIL4.txt
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] Source: fr -> Target: it
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] File size: 129 bytes
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] First 200 bytes: b"\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse de l'immeuble: [\xc3\x80 compl\xc3\xa9ter]"
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] Use glossary: True
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] Using default glossary: glossary/glossary.csv
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] Found 1 recent requests with same hash, but all are completed
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] Allowing re-translation - will check memory first
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] Generated job_id: 5139d21c-6ed5-4d4a-b731-1248c3c7488e
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: Created isolated input file: input_5139d21c-6ed5-4d4a-b731-1248c3c7488e_1sh543iy.txt
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: File hash: 6c27678b16998564...
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e stored in translation_jobs
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] Total active jobs: 1
2025-12-29 20:52:54 - src.translator.api - INFO - ================================================================================
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: Translation thread started
2025-12-29 20:52:54 - src.translator.api - INFO - [TRANSLATION 5139d21c-6ed5-4d4a-b731-1248c3c7488e] ===== STARTING TRANSLATION THREAD =====
2025-12-29 20:52:54 - src.translator.api - INFO - [REQUEST 77fd42e6] ===== REQUEST PROCESSING COMPLETE =====
2025-12-29 20:52:54 - src.translator.api - INFO - [TRANSLATION 5139d21c-6ed5-4d4a-b731-1248c3c7488e] Job data from storage:
2025-12-29 20:52:54 - src.translator.api - INFO - ================================================================================
2025-12-29 20:52:54 - src.translator.api - INFO - [TRANSLATION 5139d21c-6ed5-4d4a-b731-1248c3c7488e]   - File hash: 6c27678b169985646fa3b971e35c8042
INFO:     127.0.0.1:60299 - "POST /api/translate HTTP/1.1" 202 Accepted
2025-12-29 20:52:54 - src.translator.api - INFO - [TRANSLATION 5139d21c-6ed5-4d4a-b731-1248c3c7488e]   - Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_5139d21c-6ed5-4d4a-b731-1248c3c7488e_1sh543iy.txt
2025-12-29 20:52:54 - src.translator.api - INFO - [TRANSLATION 5139d21c-6ed5-4d4a-b731-1248c3c7488e]   - Source: fr -> Target: it
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [FILE VERIFICATION] Opening file: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_5139d21c-6ed5-4d4a-b731-1248c3c7488e_1sh543iy.txt
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [FILE VERIFICATION] File absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_5139d21c-6ed5-4d4a-b731-1248c3c7488e_1sh543iy.txt
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [FILE VERIFICATION] File exists: True
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [FILE VERIFICATION] Read 129 bytes from file
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [FILE VERIFICATION] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [FILE VERIFICATION] Actual hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [FILE VERIFICATION] First 100 bytes: b'\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse d'
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [FILE VERIFICATION] Hash verified successfully
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [FILE VERIFICATION] File: input_5139d21c-6ed5-4d4a-b731-1248c3c7488e_1sh543iy.txt, Size: 129 bytes
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: Created isolated temp directory: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/translation_5139d21c-6ed5-4d4a-b731-1248c3c7488e_yv4lx390
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: Loading glossary from glossary/glossary.csv (file will be read fresh)
INFO:     127.0.0.1:60301 - "GET /api/translate/5139d21c-6ed5-4d4a-b731-1248c3c7488e/status HTTP/1.1" 200 OK
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: Loaded glossary 'glossary' with 1350 entries
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: Using shared translation memory from /Users/enrico/workspace/translator/data/memory.json
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: Memory contains 202 existing records
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: Using custom prompt provided by user
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [PRE-TRANSLATE] About to call translate_file_to_memory
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [PRE-TRANSLATE] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_5139d21c-6ed5-4d4a-b731-1248c3c7488e_1sh543iy.txt
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [PRE-TRANSLATE] Input path absolute: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_5139d21c-6ed5-4d4a-b731-1248c3c7488e_1sh543iy.txt
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [PRE-TRANSLATE] Input file exists: True
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [PRE-TRANSLATE] Final verification - Hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [PRE-TRANSLATE] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [PRE-TRANSLATE] File verified, calling translate_file_to_memory
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: [PRE-TRANSLATE] Source lang: fr, Target lang: it
2025-12-29 20:52:54 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: Stored 3 original paragraphs
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] ===== STARTING SINGLE-SHOT TRANSLATION =====
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_5139d21c-6ed5-4d4a-b731-1248c3c7488e_1sh543iy.txt
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_5139d21c-6ed5-4d4a-b731-1248c3c7488e_1sh543iy.txt
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] File size: 129 bytes
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Reading entire file as text...
2025-12-29 20:52:54 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_5139d21c-6ed5-4d4a-b731-1248c3c7488e_1sh543iy.txt
2025-12-29 20:52:54 - src.translator.processing - INFO - [_read_file_as_text] File type: .txt
2025-12-29 20:52:54 - src.translator.processing - INFO - [_read_file_as_text] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:54 - src.translator.processing - INFO - [_read_file_as_text] File size: 129 bytes
2025-12-29 20:52:54 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 121 characters
2025-12-29 20:52:54 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces  
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À compléter]...
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Looking up glossary matches...
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Found 0 glossary matches (after filtering reference doc conflicts)
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 1: CHECKING TRANSLATION MEMORY =====
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Memory enabled (skip_memory=False), checking for existing translation...
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Document length: 121 characters
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Found memory match with similarity: 100.0%
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Memory source preview: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces au ___ étage
☐ Maison de ______ pièces
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À co...
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Memory translation preview: # TRADUZIONE

## 2. OGGETTO DELLA LOCAZIONE

☐ Sgabuzzino di ______ locali al ___ piano
☐ Casa di ______ locali
☐ ______ camera/e ammobiliata/e

Indir...
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] ✅ STEP 1 RESULT: Using translation from memory (similarity: 100.0%)
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] ✅ No Claude API call needed - translation retrieved from memory
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 2: SKIPPED (using memory translation) =====
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] No Claude API call needed - translation retrieved from memory
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 3: SKIPPED (translation already in memory) =====
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Translation already exists in memory, no need to store again
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Translation complete: 0.10s
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Translated length: 4,128 characters
2025-12-29 20:52:54 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applying glossary: glossary
2025-12-29 20:52:54 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Translated text length: 4128
2025-12-29 20:52:54 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applied 5 glossary terms
2025-12-29 20:52:54 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Breakdown: 4 translation matches, 1 source replacements
2025-12-29 20:52:54 - src.translator.processing - INFO - [translate_file_to_memory] Glossary enrichment: 5 terms highlighted (after filtering reference doc)
2025-12-29 20:52:54 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Applying translation memory
2025-12-29 20:52:54 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Translated text length: 4235
2025-12-29 20:52:54 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Found 15 memory records for fr->it
2025-12-29 20:52:55 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Applied 0 memory terms
2025-12-29 20:52:55 - src.translator.processing - INFO - [translate_file_to_memory] Memory enrichment: 0 terms highlighted
2025-12-29 20:52:55 - src.translator.processing - INFO - [translate_file_to_memory] Generating PDF from 3 source paragraphs and 18 translated paragraphs
2025-12-29 20:52:55 - src.translator.pdf_writer - INFO - [write_pdf_to_bytes] Creating two-column layout with 3 source paragraphs and 18 translated paragraphs
2025-12-29 20:52:55 - src.translator.processing - INFO - [translate_file_to_memory] PDF generated: 6,732 bytes
2025-12-29 20:52:55 - src.translator.api - INFO - [TRANSLATION 5139d21c-6ed5-4d4a-b731-1248c3c7488e] Translation complete
2025-12-29 20:52:55 - src.translator.api - INFO - [TRANSLATION 5139d21c-6ed5-4d4a-b731-1248c3c7488e] PDF generated in memory: 6,732 bytes
2025-12-29 20:52:55 - src.translator.api - INFO - [TRANSLATION 5139d21c-6ed5-4d4a-b731-1248c3c7488e] Original paragraphs: 3
2025-12-29 20:52:55 - src.translator.api - INFO - [TRANSLATION 5139d21c-6ed5-4d4a-b731-1248c3c7488e] Translated paragraphs: 18
2025-12-29 20:52:55 - src.translator.api - INFO - [TRANSLATION 5139d21c-6ed5-4d4a-b731-1248c3c7488e] Status updated to completed
2025-12-29 20:52:55 - src.translator.api - INFO - [TRANSLATION 5139d21c-6ed5-4d4a-b731-1248c3c7488e] Final job hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:52:55 - src.translator.api - INFO - [TRANSLATION 5139d21c-6ed5-4d4a-b731-1248c3c7488e] ===== TRANSLATION COMPLETE =====
2025-12-29 20:52:55 - src.translator.api - INFO - ================================================================================
2025-12-29 20:52:55 - src.translator.api - INFO - Job 5139d21c-6ed5-4d4a-b731-1248c3c7488e: Cleaned up input file
INFO:     127.0.0.1:60303 - "GET /api/translate/5139d21c-6ed5-4d4a-b731-1248c3c7488e/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60305 - "GET /api/translate/5139d21c-6ed5-4d4a-b731-1248c3c7488e/report HTTP/1.1" 200 OK
INFO:     127.0.0.1:60307 - "GET /api/user-role HTTP/1.1" 200 OK
2025-12-29 20:53:02 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 20:53:02 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 20:53:02 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60309 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 20:53:02 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 20:53:02 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 20:53:02 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60311 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 20:53:07 - src.translator.api - INFO - Detected language: fr (prob: 1.00) -> fr
INFO:     127.0.0.1:60313 - "POST /api/detect-language HTTP/1.1" 200 OK
2025-12-29 20:53:08 - src.translator.api - INFO - ================================================================================
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] ===== NEW TRANSLATION REQUEST =====
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] Timestamp: 1767037988.387056
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] File name: OBJET DU BAIL4.txt
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] Source: fr -> Target: it
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] File size: 129 bytes
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] First 200 bytes: b"\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse de l'immeuble: [\xc3\x80 compl\xc3\xa9ter]"
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] Use glossary: True
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] Using default glossary: glossary/glossary.csv
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] Found 2 recent requests with same hash, but all are completed
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] Allowing re-translation - will check memory first
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] Generated job_id: 4b389e9d-ae21-4ff4-bd94-2dd5489229e0
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: Created isolated input file: input_4b389e9d-ae21-4ff4-bd94-2dd5489229e0_uz2cbmy0.txt
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: File hash: 6c27678b16998564...
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0 stored in translation_jobs
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] Total active jobs: 1
2025-12-29 20:53:08 - src.translator.api - INFO - ================================================================================
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: Translation thread started
2025-12-29 20:53:08 - src.translator.api - INFO - [TRANSLATION 4b389e9d-ae21-4ff4-bd94-2dd5489229e0] ===== STARTING TRANSLATION THREAD =====
2025-12-29 20:53:08 - src.translator.api - INFO - [REQUEST d4384281] ===== REQUEST PROCESSING COMPLETE =====
2025-12-29 20:53:08 - src.translator.api - INFO - [TRANSLATION 4b389e9d-ae21-4ff4-bd94-2dd5489229e0] Job data from storage:
2025-12-29 20:53:08 - src.translator.api - INFO - ================================================================================
2025-12-29 20:53:08 - src.translator.api - INFO - [TRANSLATION 4b389e9d-ae21-4ff4-bd94-2dd5489229e0]   - File hash: 6c27678b169985646fa3b971e35c8042
INFO:     127.0.0.1:60315 - "POST /api/translate HTTP/1.1" 202 Accepted
2025-12-29 20:53:08 - src.translator.api - INFO - [TRANSLATION 4b389e9d-ae21-4ff4-bd94-2dd5489229e0]   - Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4b389e9d-ae21-4ff4-bd94-2dd5489229e0_uz2cbmy0.txt
2025-12-29 20:53:08 - src.translator.api - INFO - [TRANSLATION 4b389e9d-ae21-4ff4-bd94-2dd5489229e0]   - Source: fr -> Target: it
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [FILE VERIFICATION] Opening file: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4b389e9d-ae21-4ff4-bd94-2dd5489229e0_uz2cbmy0.txt
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [FILE VERIFICATION] File absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4b389e9d-ae21-4ff4-bd94-2dd5489229e0_uz2cbmy0.txt
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [FILE VERIFICATION] File exists: True
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [FILE VERIFICATION] Read 129 bytes from file
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [FILE VERIFICATION] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [FILE VERIFICATION] Actual hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [FILE VERIFICATION] First 100 bytes: b'\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse d'
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [FILE VERIFICATION] Hash verified successfully
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [FILE VERIFICATION] File: input_4b389e9d-ae21-4ff4-bd94-2dd5489229e0_uz2cbmy0.txt, Size: 129 bytes
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: Created isolated temp directory: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/translation_4b389e9d-ae21-4ff4-bd94-2dd5489229e0_qve48r8r
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: Loading glossary from glossary/glossary.csv (file will be read fresh)
INFO:     127.0.0.1:60317 - "GET /api/translate/4b389e9d-ae21-4ff4-bd94-2dd5489229e0/status HTTP/1.1" 200 OK
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: Loaded glossary 'glossary' with 1350 entries
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: Using shared translation memory from /Users/enrico/workspace/translator/data/memory.json
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: Memory contains 202 existing records
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: Using role-specific prompt for role: '' (length: 0)
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [PRE-TRANSLATE] About to call translate_file_to_memory
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [PRE-TRANSLATE] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4b389e9d-ae21-4ff4-bd94-2dd5489229e0_uz2cbmy0.txt
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [PRE-TRANSLATE] Input path absolute: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4b389e9d-ae21-4ff4-bd94-2dd5489229e0_uz2cbmy0.txt
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [PRE-TRANSLATE] Input file exists: True
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [PRE-TRANSLATE] Final verification - Hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [PRE-TRANSLATE] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [PRE-TRANSLATE] File verified, calling translate_file_to_memory
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: [PRE-TRANSLATE] Source lang: fr, Target lang: it
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: Stored 3 original paragraphs
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] ===== STARTING SINGLE-SHOT TRANSLATION =====
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4b389e9d-ae21-4ff4-bd94-2dd5489229e0_uz2cbmy0.txt
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4b389e9d-ae21-4ff4-bd94-2dd5489229e0_uz2cbmy0.txt
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] File size: 129 bytes
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Reading entire file as text...
2025-12-29 20:53:08 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4b389e9d-ae21-4ff4-bd94-2dd5489229e0_uz2cbmy0.txt
2025-12-29 20:53:08 - src.translator.processing - INFO - [_read_file_as_text] File type: .txt
2025-12-29 20:53:08 - src.translator.processing - INFO - [_read_file_as_text] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:08 - src.translator.processing - INFO - [_read_file_as_text] File size: 129 bytes
2025-12-29 20:53:08 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 121 characters
2025-12-29 20:53:08 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces  
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À compléter]...
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Looking up glossary matches...
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Found 0 glossary matches (after filtering reference doc conflicts)
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 1: CHECKING TRANSLATION MEMORY =====
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Memory enabled (skip_memory=False), checking for existing translation...
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Document length: 121 characters
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Found memory match with similarity: 100.0%
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Memory source preview: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces au ___ étage
☐ Maison de ______ pièces
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À co...
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Memory translation preview: # TRADUZIONE

## 2. OGGETTO DELLA LOCAZIONE

☐ Sgabuzzino di ______ locali al ___ piano
☐ Casa di ______ locali
☐ ______ camera/e ammobiliata/e

Indir...
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] ✅ STEP 1 RESULT: Using translation from memory (similarity: 100.0%)
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] ✅ No Claude API call needed - translation retrieved from memory
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 2: SKIPPED (using memory translation) =====
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] No Claude API call needed - translation retrieved from memory
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 3: SKIPPED (translation already in memory) =====
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Translation already exists in memory, no need to store again
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Translation complete: 0.10s
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Translated length: 4,128 characters
2025-12-29 20:53:08 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applying glossary: glossary
2025-12-29 20:53:08 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Translated text length: 4128
2025-12-29 20:53:08 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applied 5 glossary terms
2025-12-29 20:53:08 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Breakdown: 4 translation matches, 1 source replacements
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Glossary enrichment: 5 terms highlighted (after filtering reference doc)
2025-12-29 20:53:08 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Applying translation memory
2025-12-29 20:53:08 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Translated text length: 4235
2025-12-29 20:53:08 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Found 15 memory records for fr->it
2025-12-29 20:53:08 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Applied 0 memory terms
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Memory enrichment: 0 terms highlighted
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] Generating PDF from 3 source paragraphs and 18 translated paragraphs
2025-12-29 20:53:08 - src.translator.pdf_writer - INFO - [write_pdf_to_bytes] Creating two-column layout with 3 source paragraphs and 18 translated paragraphs
2025-12-29 20:53:08 - src.translator.processing - INFO - [translate_file_to_memory] PDF generated: 6,732 bytes
2025-12-29 20:53:08 - src.translator.api - INFO - [TRANSLATION 4b389e9d-ae21-4ff4-bd94-2dd5489229e0] Translation complete
2025-12-29 20:53:08 - src.translator.api - INFO - [TRANSLATION 4b389e9d-ae21-4ff4-bd94-2dd5489229e0] PDF generated in memory: 6,732 bytes
2025-12-29 20:53:08 - src.translator.api - INFO - [TRANSLATION 4b389e9d-ae21-4ff4-bd94-2dd5489229e0] Original paragraphs: 3
2025-12-29 20:53:08 - src.translator.api - INFO - [TRANSLATION 4b389e9d-ae21-4ff4-bd94-2dd5489229e0] Translated paragraphs: 18
2025-12-29 20:53:08 - src.translator.api - INFO - [TRANSLATION 4b389e9d-ae21-4ff4-bd94-2dd5489229e0] Status updated to completed
2025-12-29 20:53:08 - src.translator.api - INFO - [TRANSLATION 4b389e9d-ae21-4ff4-bd94-2dd5489229e0] Final job hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:08 - src.translator.api - INFO - [TRANSLATION 4b389e9d-ae21-4ff4-bd94-2dd5489229e0] ===== TRANSLATION COMPLETE =====
2025-12-29 20:53:08 - src.translator.api - INFO - ================================================================================
2025-12-29 20:53:08 - src.translator.api - INFO - Job 4b389e9d-ae21-4ff4-bd94-2dd5489229e0: Cleaned up input file
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60320 - "GET /api/translate/4b389e9d-ae21-4ff4-bd94-2dd5489229e0/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60322 - "GET /api/translate/4b389e9d-ae21-4ff4-bd94-2dd5489229e0/report HTTP/1.1" 200 OK
2025-12-29 20:53:12 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 20:53:12 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 20:53:12 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60329 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 20:53:12 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 20:53:12 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 20:53:12 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60331 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 20:53:22 - src.translator.api - INFO - Detected language: fr (prob: 1.00) -> fr
INFO:     127.0.0.1:60335 - "POST /api/detect-language HTTP/1.1" 200 OK
2025-12-29 20:53:31 - src.translator.api - INFO - ================================================================================
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] ===== NEW TRANSLATION REQUEST =====
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] Timestamp: 1767038011.92124
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] File name: OBJET DU BAIL4.txt
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] Source: fr -> Target: it
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] File size: 129 bytes
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] First 200 bytes: b"\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse de l'immeuble: [\xc3\x80 compl\xc3\xa9ter]"
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] Use glossary: True
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] Using default glossary: glossary/glossary.csv
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] Found 2 recent requests with same hash, but all are completed
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] Allowing re-translation - will check memory first
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] Generated job_id: 8b034034-4098-45cc-b8ef-68ace5c6ba18
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: Created isolated input file: input_8b034034-4098-45cc-b8ef-68ace5c6ba18_vw96mmc3.txt
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: File hash: 6c27678b16998564...
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] Job 8b034034-4098-45cc-b8ef-68ace5c6ba18 stored in translation_jobs
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] Total active jobs: 1
2025-12-29 20:53:31 - src.translator.api - INFO - ================================================================================
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: Translation thread started
2025-12-29 20:53:31 - src.translator.api - INFO - [TRANSLATION 8b034034-4098-45cc-b8ef-68ace5c6ba18] ===== STARTING TRANSLATION THREAD =====
2025-12-29 20:53:31 - src.translator.api - INFO - [REQUEST f1de0df6] ===== REQUEST PROCESSING COMPLETE =====
2025-12-29 20:53:31 - src.translator.api - INFO - [TRANSLATION 8b034034-4098-45cc-b8ef-68ace5c6ba18] Job data from storage:
2025-12-29 20:53:31 - src.translator.api - INFO - ================================================================================
2025-12-29 20:53:31 - src.translator.api - INFO - [TRANSLATION 8b034034-4098-45cc-b8ef-68ace5c6ba18]   - File hash: 6c27678b169985646fa3b971e35c8042
INFO:     127.0.0.1:60341 - "POST /api/translate HTTP/1.1" 202 Accepted
2025-12-29 20:53:31 - src.translator.api - INFO - [TRANSLATION 8b034034-4098-45cc-b8ef-68ace5c6ba18]   - Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_8b034034-4098-45cc-b8ef-68ace5c6ba18_vw96mmc3.txt
2025-12-29 20:53:31 - src.translator.api - INFO - [TRANSLATION 8b034034-4098-45cc-b8ef-68ace5c6ba18]   - Source: fr -> Target: it
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [FILE VERIFICATION] Opening file: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_8b034034-4098-45cc-b8ef-68ace5c6ba18_vw96mmc3.txt
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [FILE VERIFICATION] File absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_8b034034-4098-45cc-b8ef-68ace5c6ba18_vw96mmc3.txt
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [FILE VERIFICATION] File exists: True
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [FILE VERIFICATION] Read 129 bytes from file
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [FILE VERIFICATION] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [FILE VERIFICATION] Actual hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [FILE VERIFICATION] First 100 bytes: b'\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse d'
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [FILE VERIFICATION] Hash verified successfully
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [FILE VERIFICATION] File: input_8b034034-4098-45cc-b8ef-68ace5c6ba18_vw96mmc3.txt, Size: 129 bytes
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: Created isolated temp directory: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/translation_8b034034-4098-45cc-b8ef-68ace5c6ba18_xjs4ilk3
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: Loading glossary from glossary/glossary.csv (file will be read fresh)
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: Loaded glossary 'glossary' with 1350 entries
INFO:     127.0.0.1:60343 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: Using shared translation memory from /Users/enrico/workspace/translator/data/memory.json
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: Memory contains 202 existing records
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: Using role-specific prompt for role: '' (length: 0)
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [PRE-TRANSLATE] About to call translate_file_to_memory
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [PRE-TRANSLATE] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_8b034034-4098-45cc-b8ef-68ace5c6ba18_vw96mmc3.txt
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [PRE-TRANSLATE] Input path absolute: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_8b034034-4098-45cc-b8ef-68ace5c6ba18_vw96mmc3.txt
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [PRE-TRANSLATE] Input file exists: True
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [PRE-TRANSLATE] Final verification - Hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [PRE-TRANSLATE] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [PRE-TRANSLATE] File verified, calling translate_file_to_memory
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: [PRE-TRANSLATE] Source lang: fr, Target lang: it
2025-12-29 20:53:31 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: Stored 3 original paragraphs
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] ===== STARTING SINGLE-SHOT TRANSLATION =====
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_8b034034-4098-45cc-b8ef-68ace5c6ba18_vw96mmc3.txt
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_8b034034-4098-45cc-b8ef-68ace5c6ba18_vw96mmc3.txt
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] File size: 129 bytes
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] Reading entire file as text...
2025-12-29 20:53:31 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_8b034034-4098-45cc-b8ef-68ace5c6ba18_vw96mmc3.txt
2025-12-29 20:53:31 - src.translator.processing - INFO - [_read_file_as_text] File type: .txt
2025-12-29 20:53:31 - src.translator.processing - INFO - [_read_file_as_text] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:31 - src.translator.processing - INFO - [_read_file_as_text] File size: 129 bytes
2025-12-29 20:53:31 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 121 characters
2025-12-29 20:53:31 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces  
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À compléter]...
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] Looking up glossary matches...
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] Found 0 glossary matches (after filtering reference doc conflicts)
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 1: SKIPPED (skip_memory=True) =====
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] Translation memory disabled, proceeding directly to Claude API
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 2: QUERYING CLAUDE API =====
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] Sending entire document to Claude API (single call)
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] Document length: 121 characters
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] Glossary matches: 0
2025-12-29 20:53:31 - src.translator.processing - INFO - [translate_file_to_memory] Memory hits for context: 0
2025-12-29 20:53:31 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 20:53:31 - src.translator.claude_client - INFO - 🚀 CLAUDE API REQUEST - ENTIRE DOCUMENT (SINGLE SHOT)
2025-12-29 20:53:31 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 20:53:31 - src.translator.claude_client - INFO - Model: claude-sonnet-4-5-20250929
2025-12-29 20:53:31 - src.translator.claude_client - INFO - Max tokens: 8192
2025-12-29 20:53:31 - src.translator.claude_client - INFO - Document length: 121 characters
2025-12-29 20:53:31 - src.translator.claude_client - INFO - Total prompt length: 11,700 characters (~2,925 tokens)
2025-12-29 20:53:31 - src.translator.claude_client - INFO - Source language: fr -> Target language: it
2025-12-29 20:53:31 - src.translator.claude_client - INFO - Glossary entries: 0
2025-12-29 20:53:31 - src.translator.claude_client - INFO - Memory entries: 0
2025-12-29 20:53:31 - src.translator.claude_client - INFO - --------------------------------------------------------------------------------
2025-12-29 20:53:31 - src.translator.claude_client - INFO - 📝 DOCUMENT PREVIEW (first 500 chars):
2025-12-29 20:53:31 - src.translator.claude_client - INFO - 

2. OBJET DU BAIL

☐ Appartement de ______ pièces  
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À compléter]...
2025-12-29 20:53:31 - src.translator.claude_client - INFO - --------------------------------------------------------------------------------
2025-12-29 20:53:31 - src.translator.claude_client - INFO - ⏱️  Sending entire document to Claude API in single call...
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60347 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60349 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60351 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60353 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60355 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60357 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60360 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60362 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60365 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60367 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60369 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
2025-12-29 20:53:55 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-12-29 20:53:55 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 20:53:55 - src.translator.claude_client - INFO - ✅ CLAUDE API RESPONSE RECEIVED
2025-12-29 20:53:55 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 20:53:55 - src.translator.claude_client - INFO - ⏱️  Request duration: 23.24 seconds (0.39 minutes)
2025-12-29 20:53:55 - src.translator.claude_client - INFO - 📊 Response length: 3,037 characters
2025-12-29 20:53:55 - src.translator.claude_client - INFO - 📈 Token usage:
2025-12-29 20:53:55 - src.translator.claude_client - INFO -   - Input tokens: 3816
2025-12-29 20:53:55 - src.translator.claude_client - INFO -   - Output tokens: 992
2025-12-29 20:53:55 - src.translator.claude_client - INFO - 📝 TRANSLATION PREVIEW (first 500 chars):
2025-12-29 20:53:55 - src.translator.claude_client - INFO - # TRADUZIONE

## 2. OGGETTO DELLA LOCAZIONE

☐ Appartamento di ______ locali  
☐ ______ camera/e ammobiliata/e

Indirizzo dell'immobile: [Da completare]

---

# TABELLA COMPARATIVA

| **Originale (FR)** | **Traduzione (IT)** | **Spiegazione** | **Fonte** |
|-------------------|---------------------|-----------------|-----------|
| OBJET DU BAIL | OGGETTO DELLA LOCAZIONE | In ambito locativo svizzero, "bail" si traduce sistematicamente con "locazione" (non "affitto"). Il termine è coerente con la...
2025-12-29 20:53:55 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 20:53:55 - src.translator.processing - INFO - [translate_file_to_memory] ✅ STEP 2 RESULT: Claude API translation completed in 23.24s
2025-12-29 20:53:55 - src.translator.processing - INFO - [translate_file_to_memory] Translated length: 3,037 characters
2025-12-29 20:53:55 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 3: SKIPPED (skip_memory=True) =====
2025-12-29 20:53:55 - src.translator.processing - INFO - [translate_file_to_memory] Translation memory disabled, not storing translation
2025-12-29 20:53:55 - src.translator.processing - INFO - [translate_file_to_memory] Translation complete: 23.24s
2025-12-29 20:53:55 - src.translator.processing - INFO - [translate_file_to_memory] Translated length: 3,037 characters
2025-12-29 20:53:55 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applying glossary: glossary
2025-12-29 20:53:55 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Translated text length: 3037
2025-12-29 20:53:55 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applied 6 glossary terms
2025-12-29 20:53:55 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Breakdown: 6 translation matches, 0 source replacements
2025-12-29 20:53:55 - src.translator.processing - INFO - [translate_file_to_memory] Glossary enrichment: 6 terms highlighted (after filtering reference doc)
2025-12-29 20:53:55 - src.translator.processing - INFO - [translate_file_to_memory] Memory enrichment skipped (skip_memory=True)
2025-12-29 20:53:55 - src.translator.processing - INFO - [translate_file_to_memory] Generating PDF from 3 source paragraphs and 14 translated paragraphs
2025-12-29 20:53:55 - src.translator.pdf_writer - INFO - [write_pdf_to_bytes] Creating two-column layout with 3 source paragraphs and 14 translated paragraphs
2025-12-29 20:53:55 - src.translator.processing - INFO - [translate_file_to_memory] PDF generated: 5,708 bytes
2025-12-29 20:53:55 - src.translator.api - INFO - [TRANSLATION 8b034034-4098-45cc-b8ef-68ace5c6ba18] Translation complete
2025-12-29 20:53:55 - src.translator.api - INFO - [TRANSLATION 8b034034-4098-45cc-b8ef-68ace5c6ba18] PDF generated in memory: 5,708 bytes
2025-12-29 20:53:55 - src.translator.api - INFO - [TRANSLATION 8b034034-4098-45cc-b8ef-68ace5c6ba18] Original paragraphs: 3
2025-12-29 20:53:55 - src.translator.api - INFO - [TRANSLATION 8b034034-4098-45cc-b8ef-68ace5c6ba18] Translated paragraphs: 14
2025-12-29 20:53:55 - src.translator.api - INFO - [TRANSLATION 8b034034-4098-45cc-b8ef-68ace5c6ba18] Status updated to completed
2025-12-29 20:53:55 - src.translator.api - INFO - [TRANSLATION 8b034034-4098-45cc-b8ef-68ace5c6ba18] Final job hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 20:53:55 - src.translator.api - INFO - [TRANSLATION 8b034034-4098-45cc-b8ef-68ace5c6ba18] ===== TRANSLATION COMPLETE =====
2025-12-29 20:53:55 - src.translator.api - INFO - ================================================================================
2025-12-29 20:53:55 - src.translator.api - INFO - Job 8b034034-4098-45cc-b8ef-68ace5c6ba18: Cleaned up input file
INFO:     127.0.0.1:60373 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60375 - "GET /api/translate/8b034034-4098-45cc-b8ef-68ace5c6ba18/report HTTP/1.1" 200 OK
2025-12-29 20:54:42 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 20:54:42 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 20:54:42 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60387 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 20:54:42 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 20:54:42 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 20:54:42 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60389 - "GET /api/prompt HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:60741 - "GET /api/user-role HTTP/1.1" 200 OK
2025-12-29 21:03:54 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:03:54 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:03:54 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60743 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 21:03:54 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:03:54 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:03:54 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60745 - "GET /api/prompt HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:60748 - "GET /api/user-role HTTP/1.1" 200 OK
2025-12-29 21:04:00 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:04:00 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:04:00 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60750 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 21:04:00 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:04:00 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:04:00 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60752 - "GET /api/prompt HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:60755 - "GET /api/user-role HTTP/1.1" 200 OK
2025-12-29 21:04:07 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:04:07 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:04:07 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60757 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 21:04:07 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:04:07 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:04:07 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60759 - "GET /api/prompt HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:60762 - "GET /api/user-role HTTP/1.1" 200 OK
2025-12-29 21:04:11 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:04:11 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:04:11 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60764 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 21:04:11 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:04:11 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:04:11 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:60767 - "GET /api/prompt HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:60808 - "GET /api/user-role HTTP/1.1" 200 OK
2025-12-29 21:05:29 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:05:29 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:05:29 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60810 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 21:05:29 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:05:29 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:05:29 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60812 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 21:06:46 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:06:46 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:06:46 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60850 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 21:07:33 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:07:33 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:07:33 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60889 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 21:08:41 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:08:41 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:08:41 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60961 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 21:08:41 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:08:41 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:08:41 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60962 - "GET /api/prompt HTTP/1.1" 200 OK
INFO:     127.0.0.1:60974 - "GET /api/user-role HTTP/1.1" 200 OK
2025-12-29 21:09:14 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:09:14 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:09:14 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60976 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 21:09:14 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:09:14 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:09:14 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60978 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 21:09:29 - src.translator.api - INFO - Detected language: fr (prob: 1.00) -> fr
INFO:     127.0.0.1:60983 - "POST /api/detect-language HTTP/1.1" 200 OK
2025-12-29 21:09:31 - src.translator.api - INFO - ================================================================================
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] ===== NEW TRANSLATION REQUEST =====
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] Timestamp: 1767038971.919304
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] File name: OBJET DU BAIL4.txt
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] Source: fr -> Target: it
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] File size: 129 bytes
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] First 200 bytes: b"\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse de l'immeuble: [\xc3\x80 compl\xc3\xa9ter]"
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] Use glossary: True
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] Using default glossary: glossary/glossary.csv
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] Generated job_id: 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: Created isolated input file: input_4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df_mbnc1nco.txt
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: File hash: 6c27678b16998564...
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df stored in translation_jobs
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] Total active jobs: 1
2025-12-29 21:09:31 - src.translator.api - INFO - ================================================================================
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: Translation thread started
2025-12-29 21:09:31 - src.translator.api - INFO - [TRANSLATION 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df] ===== STARTING TRANSLATION THREAD =====
2025-12-29 21:09:31 - src.translator.api - INFO - [REQUEST e3357ffd] ===== REQUEST PROCESSING COMPLETE =====
2025-12-29 21:09:31 - src.translator.api - INFO - [TRANSLATION 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df] Job data from storage:
2025-12-29 21:09:31 - src.translator.api - INFO - ================================================================================
2025-12-29 21:09:31 - src.translator.api - INFO - [TRANSLATION 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df]   - File hash: 6c27678b169985646fa3b971e35c8042
INFO:     127.0.0.1:60985 - "POST /api/translate HTTP/1.1" 202 Accepted
2025-12-29 21:09:31 - src.translator.api - INFO - [TRANSLATION 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df]   - Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df_mbnc1nco.txt
2025-12-29 21:09:31 - src.translator.api - INFO - [TRANSLATION 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df]   - Source: fr -> Target: it
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [FILE VERIFICATION] Opening file: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df_mbnc1nco.txt
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [FILE VERIFICATION] File absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df_mbnc1nco.txt
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [FILE VERIFICATION] File exists: True
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [FILE VERIFICATION] Read 129 bytes from file
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [FILE VERIFICATION] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [FILE VERIFICATION] Actual hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [FILE VERIFICATION] First 100 bytes: b'\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse d'
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [FILE VERIFICATION] Hash verified successfully
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [FILE VERIFICATION] File: input_4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df_mbnc1nco.txt, Size: 129 bytes
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: Created isolated temp directory: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/translation_4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df_1lslobj5
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: Loading glossary from glossary/glossary.csv (file will be read fresh)
INFO:     127.0.0.1:60987 - "GET /api/translate/4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df/status HTTP/1.1" 200 OK
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: Loaded glossary 'glossary' with 1350 entries
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: Using shared translation memory from /Users/enrico/workspace/translator/data/memory.json
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: Memory contains 202 existing records
2025-12-29 21:09:31 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: Using custom prompt provided by user
2025-12-29 21:09:32 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [PRE-TRANSLATE] About to call translate_file_to_memory
2025-12-29 21:09:32 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [PRE-TRANSLATE] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df_mbnc1nco.txt
2025-12-29 21:09:32 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [PRE-TRANSLATE] Input path absolute: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df_mbnc1nco.txt
2025-12-29 21:09:32 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [PRE-TRANSLATE] Input file exists: True
2025-12-29 21:09:32 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [PRE-TRANSLATE] Final verification - Hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:09:32 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [PRE-TRANSLATE] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:09:32 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [PRE-TRANSLATE] File verified, calling translate_file_to_memory
2025-12-29 21:09:32 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: [PRE-TRANSLATE] Source lang: fr, Target lang: it
2025-12-29 21:09:32 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: Stored 3 original paragraphs
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] ===== STARTING SINGLE-SHOT TRANSLATION =====
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df_mbnc1nco.txt
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df_mbnc1nco.txt
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] File size: 129 bytes
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Reading entire file as text...
2025-12-29 21:09:32 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df_mbnc1nco.txt
2025-12-29 21:09:32 - src.translator.processing - INFO - [_read_file_as_text] File type: .txt
2025-12-29 21:09:32 - src.translator.processing - INFO - [_read_file_as_text] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:09:32 - src.translator.processing - INFO - [_read_file_as_text] File size: 129 bytes
2025-12-29 21:09:32 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 121 characters
2025-12-29 21:09:32 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces  
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À compléter]...
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Looking up glossary matches...
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Found 0 glossary matches (after filtering reference doc conflicts)
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 1: CHECKING TRANSLATION MEMORY =====
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Memory enabled (skip_memory=False), checking for existing translation...
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Document length: 121 characters
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Found memory match with similarity: 100.0%
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Memory source preview: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces au ___ étage
☐ Maison de ______ pièces
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À co...
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Memory translation preview: # TRADUZIONE

## 2. OGGETTO DELLA LOCAZIONE

☐ Sgabuzzino di ______ locali al ___ piano
☐ Casa di ______ locali
☐ ______ camera/e ammobiliata/e

Indir...
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] ✅ STEP 1 RESULT: Using translation from memory (similarity: 100.0%)
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] ✅ No Claude API call needed - translation retrieved from memory
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 2: SKIPPED (using memory translation) =====
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] No Claude API call needed - translation retrieved from memory
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 3: SKIPPED (translation already in memory) =====
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Translation already exists in memory, no need to store again
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Translation complete: 0.10s
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Translated length: 4,128 characters
2025-12-29 21:09:32 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applying glossary: glossary
2025-12-29 21:09:32 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Translated text length: 4128
2025-12-29 21:09:32 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applied 5 glossary terms
2025-12-29 21:09:32 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Breakdown: 4 translation matches, 1 source replacements
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Glossary enrichment: 5 terms highlighted (after filtering reference doc)
2025-12-29 21:09:32 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Applying translation memory
2025-12-29 21:09:32 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Translated text length: 4235
2025-12-29 21:09:32 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Found 15 memory records for fr->it
2025-12-29 21:09:32 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Applied 0 memory terms
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Memory enrichment: 0 terms highlighted
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] Generating PDF from 3 source paragraphs and 18 translated paragraphs
2025-12-29 21:09:32 - src.translator.pdf_writer - INFO - [write_pdf_to_bytes] Creating two-column layout with 3 source paragraphs and 18 translated paragraphs
2025-12-29 21:09:32 - src.translator.processing - INFO - [translate_file_to_memory] PDF generated: 6,732 bytes
2025-12-29 21:09:32 - src.translator.api - INFO - [TRANSLATION 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df] Translation complete
2025-12-29 21:09:32 - src.translator.api - INFO - [TRANSLATION 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df] PDF generated in memory: 6,732 bytes
2025-12-29 21:09:32 - src.translator.api - INFO - [TRANSLATION 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df] Original paragraphs: 3
2025-12-29 21:09:32 - src.translator.api - INFO - [TRANSLATION 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df] Translated paragraphs: 18
2025-12-29 21:09:32 - src.translator.api - INFO - [TRANSLATION 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df] Status updated to completed
2025-12-29 21:09:32 - src.translator.api - INFO - [TRANSLATION 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df] Final job hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:09:32 - src.translator.api - INFO - [TRANSLATION 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df] ===== TRANSLATION COMPLETE =====
2025-12-29 21:09:32 - src.translator.api - INFO - ================================================================================
2025-12-29 21:09:32 - src.translator.api - INFO - Job 4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df: Cleaned up input file
INFO:     127.0.0.1:60989 - "GET /api/translate/4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:60991 - "GET /api/translate/4a8aa8dd-ec28-4895-a4d2-e2e4f2faf9df/report HTTP/1.1" 200 OK
2025-12-29 21:09:41 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:09:41 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:09:41 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60995 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 21:09:41 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:09:41 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:09:41 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:60997 - "GET /api/prompt HTTP/1.1" 200 OK
INFO:     127.0.0.1:61107 - "GET /api/user-role HTTP/1.1" 200 OK
2025-12-29 21:12:17 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:12:17 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:12:17 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:61109 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 21:12:17 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:12:17 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:12:17 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:61111 - "GET /api/prompt HTTP/1.1" 200 OK
INFO:     127.0.0.1:61131 - "GET /api/user-role HTTP/1.1" 200 OK
2025-12-29 21:12:43 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:12:43 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:12:43 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:61133 - "GET /api/prompt HTTP/1.1" 200 OK
2025-12-29 21:12:43 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2025-12-29 21:12:43 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2025-12-29 21:12:43 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:61135 - "GET /api/prompt HTTP/1.1" 200 OK
INFO:     127.0.0.1:61140 - "GET /api/user-role HTTP/1.1" 200 OK
2025-12-29 21:13:06 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:13:06 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:13:06 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:61142 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 21:13:06 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:13:06 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:13:06 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:61144 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 21:13:13 - src.translator.api - INFO - Detected language: fr (prob: 1.00) -> fr
INFO:     127.0.0.1:61152 - "POST /api/detect-language HTTP/1.1" 200 OK
2025-12-29 21:13:16 - src.translator.api - INFO - ================================================================================
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] ===== NEW TRANSLATION REQUEST =====
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] Timestamp: 1767039196.402287
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] File name: OBJET DU BAIL3.txt
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] Source: fr -> Target: it
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] File size: 141 bytes
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] File hash: 17116c45351ce76a0cd2a39063965854
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] First 200 bytes: b"\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces au ___ \xc3\xa9tage\n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse de l'immeuble: [\xc3\x80 compl\xc3\xa9ter]"
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] Use glossary: True
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] Using default glossary: glossary/glossary.csv
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] Generated job_id: ce1f44bd-a093-455c-ac17-9f4bc8fad14a
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: Created isolated input file: input_ce1f44bd-a093-455c-ac17-9f4bc8fad14a_pchvu7fi.txt
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: File hash: 17116c45351ce76a...
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a stored in translation_jobs
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] Total active jobs: 1
2025-12-29 21:13:16 - src.translator.api - INFO - ================================================================================
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: Translation thread started
2025-12-29 21:13:16 - src.translator.api - INFO - [TRANSLATION ce1f44bd-a093-455c-ac17-9f4bc8fad14a] ===== STARTING TRANSLATION THREAD =====
2025-12-29 21:13:16 - src.translator.api - INFO - [REQUEST b7bb4816] ===== REQUEST PROCESSING COMPLETE =====
2025-12-29 21:13:16 - src.translator.api - INFO - [TRANSLATION ce1f44bd-a093-455c-ac17-9f4bc8fad14a] Job data from storage:
2025-12-29 21:13:16 - src.translator.api - INFO - ================================================================================
2025-12-29 21:13:16 - src.translator.api - INFO - [TRANSLATION ce1f44bd-a093-455c-ac17-9f4bc8fad14a]   - File hash: 17116c45351ce76a0cd2a39063965854
INFO:     127.0.0.1:61155 - "POST /api/translate HTTP/1.1" 202 Accepted
2025-12-29 21:13:16 - src.translator.api - INFO - [TRANSLATION ce1f44bd-a093-455c-ac17-9f4bc8fad14a]   - Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_ce1f44bd-a093-455c-ac17-9f4bc8fad14a_pchvu7fi.txt
2025-12-29 21:13:16 - src.translator.api - INFO - [TRANSLATION ce1f44bd-a093-455c-ac17-9f4bc8fad14a]   - Source: fr -> Target: it
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [FILE VERIFICATION] Opening file: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_ce1f44bd-a093-455c-ac17-9f4bc8fad14a_pchvu7fi.txt
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [FILE VERIFICATION] File absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_ce1f44bd-a093-455c-ac17-9f4bc8fad14a_pchvu7fi.txt
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [FILE VERIFICATION] File exists: True
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [FILE VERIFICATION] Read 141 bytes from file
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [FILE VERIFICATION] Expected hash: 17116c45351ce76a0cd2a39063965854
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [FILE VERIFICATION] Actual hash: 17116c45351ce76a0cd2a39063965854
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [FILE VERIFICATION] First 100 bytes: b'\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces au ___ \xc3\xa9tage\n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s'
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [FILE VERIFICATION] Hash verified successfully
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [FILE VERIFICATION] File: input_ce1f44bd-a093-455c-ac17-9f4bc8fad14a_pchvu7fi.txt, Size: 141 bytes
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: Created isolated temp directory: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/translation_ce1f44bd-a093-455c-ac17-9f4bc8fad14a_zx9hnxw8
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: Loading glossary from glossary/glossary.csv (file will be read fresh)
INFO:     127.0.0.1:61157 - "GET /api/translate/ce1f44bd-a093-455c-ac17-9f4bc8fad14a/status HTTP/1.1" 200 OK
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: Loaded glossary 'glossary' with 1350 entries
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: Using shared translation memory from /Users/enrico/workspace/translator/data/memory.json
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: Memory contains 202 existing records
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: Using role-specific prompt for role: '' (length: 0)
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [PRE-TRANSLATE] About to call translate_file_to_memory
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [PRE-TRANSLATE] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_ce1f44bd-a093-455c-ac17-9f4bc8fad14a_pchvu7fi.txt
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [PRE-TRANSLATE] Input path absolute: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_ce1f44bd-a093-455c-ac17-9f4bc8fad14a_pchvu7fi.txt
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [PRE-TRANSLATE] Input file exists: True
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [PRE-TRANSLATE] Final verification - Hash: 17116c45351ce76a0cd2a39063965854
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [PRE-TRANSLATE] Expected hash: 17116c45351ce76a0cd2a39063965854
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [PRE-TRANSLATE] File verified, calling translate_file_to_memory
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: [PRE-TRANSLATE] Source lang: fr, Target lang: it
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: Stored 3 original paragraphs
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] ===== STARTING SINGLE-SHOT TRANSLATION =====
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_ce1f44bd-a093-455c-ac17-9f4bc8fad14a_pchvu7fi.txt
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_ce1f44bd-a093-455c-ac17-9f4bc8fad14a_pchvu7fi.txt
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] File hash: 17116c45351ce76a0cd2a39063965854
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] File size: 141 bytes
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Reading entire file as text...
2025-12-29 21:13:16 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_ce1f44bd-a093-455c-ac17-9f4bc8fad14a_pchvu7fi.txt
2025-12-29 21:13:16 - src.translator.processing - INFO - [_read_file_as_text] File type: .txt
2025-12-29 21:13:16 - src.translator.processing - INFO - [_read_file_as_text] File hash: 17116c45351ce76a0cd2a39063965854
2025-12-29 21:13:16 - src.translator.processing - INFO - [_read_file_as_text] File size: 141 bytes
2025-12-29 21:13:16 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 132 characters
2025-12-29 21:13:16 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces au ___ étage
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À compléter]...
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Looking up glossary matches...
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Found 0 glossary matches (after filtering reference doc conflicts)
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 1: CHECKING TRANSLATION MEMORY =====
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Memory enabled (skip_memory=False), checking for existing translation...
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Document length: 132 characters
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Found memory match with similarity: 100.0%
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Memory source preview: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces au ___ étage
☐ Maison de ______ pièces
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À co...
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Memory translation preview: # TRADUZIONE

## 2. OGGETTO DELLA LOCAZIONE

☐ Sgabuzzino di ______ locali al ___ piano
☐ Casa di ______ locali
☐ ______ camera/e ammobiliata/e

Indir...
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] ✅ STEP 1 RESULT: Using translation from memory (similarity: 100.0%)
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] ✅ No Claude API call needed - translation retrieved from memory
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 2: SKIPPED (using memory translation) =====
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] No Claude API call needed - translation retrieved from memory
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 3: SKIPPED (translation already in memory) =====
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Translation already exists in memory, no need to store again
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Translation complete: 0.10s
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Translated length: 4,128 characters
2025-12-29 21:13:16 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applying glossary: glossary
2025-12-29 21:13:16 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Translated text length: 4128
2025-12-29 21:13:16 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applied 5 glossary terms
2025-12-29 21:13:16 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Breakdown: 4 translation matches, 1 source replacements
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Glossary enrichment: 5 terms highlighted (after filtering reference doc)
2025-12-29 21:13:16 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Applying translation memory
2025-12-29 21:13:16 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Translated text length: 4235
2025-12-29 21:13:16 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Found 15 memory records for fr->it
2025-12-29 21:13:16 - src.translator.glossary_enricher - INFO - [apply_memory_with_highlighting] Applied 0 memory terms
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Memory enrichment: 0 terms highlighted
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] Generating PDF from 3 source paragraphs and 18 translated paragraphs
2025-12-29 21:13:16 - src.translator.pdf_writer - INFO - [write_pdf_to_bytes] Creating two-column layout with 3 source paragraphs and 18 translated paragraphs
2025-12-29 21:13:16 - src.translator.processing - INFO - [translate_file_to_memory] PDF generated: 6,738 bytes
2025-12-29 21:13:16 - src.translator.api - INFO - [TRANSLATION ce1f44bd-a093-455c-ac17-9f4bc8fad14a] Translation complete
2025-12-29 21:13:16 - src.translator.api - INFO - [TRANSLATION ce1f44bd-a093-455c-ac17-9f4bc8fad14a] PDF generated in memory: 6,738 bytes
2025-12-29 21:13:16 - src.translator.api - INFO - [TRANSLATION ce1f44bd-a093-455c-ac17-9f4bc8fad14a] Original paragraphs: 3
2025-12-29 21:13:16 - src.translator.api - INFO - [TRANSLATION ce1f44bd-a093-455c-ac17-9f4bc8fad14a] Translated paragraphs: 18
2025-12-29 21:13:16 - src.translator.api - INFO - [TRANSLATION ce1f44bd-a093-455c-ac17-9f4bc8fad14a] Status updated to completed
2025-12-29 21:13:16 - src.translator.api - INFO - [TRANSLATION ce1f44bd-a093-455c-ac17-9f4bc8fad14a] Final job hash: 17116c45351ce76a0cd2a39063965854
2025-12-29 21:13:16 - src.translator.api - INFO - [TRANSLATION ce1f44bd-a093-455c-ac17-9f4bc8fad14a] ===== TRANSLATION COMPLETE =====
2025-12-29 21:13:16 - src.translator.api - INFO - ================================================================================
2025-12-29 21:13:16 - src.translator.api - INFO - Job ce1f44bd-a093-455c-ac17-9f4bc8fad14a: Cleaned up input file
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:61159 - "GET /api/translate/ce1f44bd-a093-455c-ac17-9f4bc8fad14a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61161 - "GET /api/translate/ce1f44bd-a093-455c-ac17-9f4bc8fad14a/report HTTP/1.1" 200 OK
2025-12-29 21:13:35 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:13:35 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:13:35 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:61166 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 21:13:35 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:13:35 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:13:35 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:61168 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 21:13:39 - src.translator.api - INFO - Detected language: fr (prob: 1.00) -> fr
INFO:     127.0.0.1:61170 - "POST /api/detect-language HTTP/1.1" 200 OK
2025-12-29 21:13:46 - src.translator.api - INFO - ================================================================================
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] ===== NEW TRANSLATION REQUEST =====
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] Timestamp: 1767039226.497542
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] File name: OBJET DU BAIL4.txt
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] Source: fr -> Target: it
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] File size: 129 bytes
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] First 200 bytes: b"\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse de l'immeuble: [\xc3\x80 compl\xc3\xa9ter]"
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] Use glossary: False
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] Generated job_id: 26bb951c-5881-48ad-96ff-6d3cd3a0b50a
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: Created isolated input file: input_26bb951c-5881-48ad-96ff-6d3cd3a0b50a_h3r7fd3c.txt
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: File hash: 6c27678b16998564...
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a stored in translation_jobs
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] Total active jobs: 1
2025-12-29 21:13:46 - src.translator.api - INFO - ================================================================================
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: Translation thread started
2025-12-29 21:13:46 - src.translator.api - INFO - [TRANSLATION 26bb951c-5881-48ad-96ff-6d3cd3a0b50a] ===== STARTING TRANSLATION THREAD =====
2025-12-29 21:13:46 - src.translator.api - INFO - [REQUEST 14640a1b] ===== REQUEST PROCESSING COMPLETE =====
2025-12-29 21:13:46 - src.translator.api - INFO - [TRANSLATION 26bb951c-5881-48ad-96ff-6d3cd3a0b50a] Job data from storage:
2025-12-29 21:13:46 - src.translator.api - INFO - ================================================================================
2025-12-29 21:13:46 - src.translator.api - INFO - [TRANSLATION 26bb951c-5881-48ad-96ff-6d3cd3a0b50a]   - File hash: 6c27678b169985646fa3b971e35c8042
INFO:     127.0.0.1:61172 - "POST /api/translate HTTP/1.1" 202 Accepted
2025-12-29 21:13:46 - src.translator.api - INFO - [TRANSLATION 26bb951c-5881-48ad-96ff-6d3cd3a0b50a]   - Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_26bb951c-5881-48ad-96ff-6d3cd3a0b50a_h3r7fd3c.txt
2025-12-29 21:13:46 - src.translator.api - INFO - [TRANSLATION 26bb951c-5881-48ad-96ff-6d3cd3a0b50a]   - Source: fr -> Target: it
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [FILE VERIFICATION] Opening file: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_26bb951c-5881-48ad-96ff-6d3cd3a0b50a_h3r7fd3c.txt
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [FILE VERIFICATION] File absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_26bb951c-5881-48ad-96ff-6d3cd3a0b50a_h3r7fd3c.txt
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [FILE VERIFICATION] File exists: True
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [FILE VERIFICATION] Read 129 bytes from file
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [FILE VERIFICATION] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [FILE VERIFICATION] Actual hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [FILE VERIFICATION] First 100 bytes: b'\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse d'
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [FILE VERIFICATION] Hash verified successfully
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [FILE VERIFICATION] File: input_26bb951c-5881-48ad-96ff-6d3cd3a0b50a_h3r7fd3c.txt, Size: 129 bytes
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: Created isolated temp directory: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/translation_26bb951c-5881-48ad-96ff-6d3cd3a0b50a_errs2bnq
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: Using shared translation memory from /Users/enrico/workspace/translator/data/memory.json
INFO:     127.0.0.1:61174 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: Memory contains 202 existing records
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: Using role-specific prompt for role: '' (length: 0)
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [PRE-TRANSLATE] About to call translate_file_to_memory
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [PRE-TRANSLATE] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_26bb951c-5881-48ad-96ff-6d3cd3a0b50a_h3r7fd3c.txt
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [PRE-TRANSLATE] Input path absolute: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_26bb951c-5881-48ad-96ff-6d3cd3a0b50a_h3r7fd3c.txt
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [PRE-TRANSLATE] Input file exists: True
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [PRE-TRANSLATE] Final verification - Hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [PRE-TRANSLATE] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [PRE-TRANSLATE] File verified, calling translate_file_to_memory
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: [PRE-TRANSLATE] Source lang: fr, Target lang: it
2025-12-29 21:13:46 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: Stored 3 original paragraphs
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] ===== STARTING SINGLE-SHOT TRANSLATION =====
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_26bb951c-5881-48ad-96ff-6d3cd3a0b50a_h3r7fd3c.txt
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_26bb951c-5881-48ad-96ff-6d3cd3a0b50a_h3r7fd3c.txt
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] File size: 129 bytes
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] Reading entire file as text...
2025-12-29 21:13:46 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_26bb951c-5881-48ad-96ff-6d3cd3a0b50a_h3r7fd3c.txt
2025-12-29 21:13:46 - src.translator.processing - INFO - [_read_file_as_text] File type: .txt
2025-12-29 21:13:46 - src.translator.processing - INFO - [_read_file_as_text] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:13:46 - src.translator.processing - INFO - [_read_file_as_text] File size: 129 bytes
2025-12-29 21:13:46 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 121 characters
2025-12-29 21:13:46 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces  
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À compléter]...
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 1: SKIPPED (skip_memory=True) =====
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] Translation memory disabled, proceeding directly to Claude API
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 2: QUERYING CLAUDE API =====
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] Sending entire document to Claude API (single call)
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] Document length: 121 characters
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] Glossary matches: 0
2025-12-29 21:13:46 - src.translator.processing - INFO - [translate_file_to_memory] Memory hits for context: 0
2025-12-29 21:13:46 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 21:13:46 - src.translator.claude_client - INFO - 🚀 CLAUDE API REQUEST - ENTIRE DOCUMENT (SINGLE SHOT)
2025-12-29 21:13:46 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 21:13:46 - src.translator.claude_client - INFO - Model: claude-sonnet-4-5-20250929
2025-12-29 21:13:46 - src.translator.claude_client - INFO - Max tokens: 8192
2025-12-29 21:13:46 - src.translator.claude_client - INFO - Document length: 121 characters
2025-12-29 21:13:46 - src.translator.claude_client - INFO - Total prompt length: 11,700 characters (~2,925 tokens)
2025-12-29 21:13:46 - src.translator.claude_client - INFO - Source language: fr -> Target language: it
2025-12-29 21:13:46 - src.translator.claude_client - INFO - Glossary entries: 0
2025-12-29 21:13:46 - src.translator.claude_client - INFO - Memory entries: 0
2025-12-29 21:13:46 - src.translator.claude_client - INFO - --------------------------------------------------------------------------------
2025-12-29 21:13:46 - src.translator.claude_client - INFO - 📝 DOCUMENT PREVIEW (first 500 chars):
2025-12-29 21:13:46 - src.translator.claude_client - INFO - 

2. OBJET DU BAIL

☐ Appartement de ______ pièces  
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À compléter]...
2025-12-29 21:13:46 - src.translator.claude_client - INFO - --------------------------------------------------------------------------------
2025-12-29 21:13:46 - src.translator.claude_client - INFO - ⏱️  Sending entire document to Claude API in single call...
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:61177 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61179 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61181 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61183 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61186 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61189 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61191 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61193 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61195 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61197 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61200 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61204 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
2025-12-29 21:14:11 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-12-29 21:14:11 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 21:14:11 - src.translator.claude_client - INFO - ✅ CLAUDE API RESPONSE RECEIVED
2025-12-29 21:14:11 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 21:14:11 - src.translator.claude_client - INFO - ⏱️  Request duration: 24.62 seconds (0.41 minutes)
2025-12-29 21:14:11 - src.translator.claude_client - INFO - 📊 Response length: 3,623 characters
2025-12-29 21:14:11 - src.translator.claude_client - INFO - 📈 Token usage:
2025-12-29 21:14:11 - src.translator.claude_client - INFO -   - Input tokens: 3816
2025-12-29 21:14:11 - src.translator.claude_client - INFO -   - Output tokens: 1184
2025-12-29 21:14:11 - src.translator.claude_client - INFO - 📝 TRANSLATION PREVIEW (first 500 chars):
2025-12-29 21:14:11 - src.translator.claude_client - INFO - # TRADUZIONE

## 2. OGGETTO DELLA LOCAZIONE

☐ Appartamento di ______ locali  
☐ ______ camera/e ammobiliata/e

Indirizzo dell'immobile: [Da completare]

---

# TABELLA COMPARATIVA

| **Originale (FR)** | **Traduzione (IT)** | **Spiegazione** | **Fonte** |
|-------------------|---------------------|-----------------|-----------|
| OBJET DU BAIL | OGGETTO DELLA LOCAZIONE | In ambito locativo svizzero, "bail" si traduce sistematicamente con "locazione" (non "affitto"). Il termine è coerente con la...
2025-12-29 21:14:11 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 21:14:11 - src.translator.processing - INFO - [translate_file_to_memory] ✅ STEP 2 RESULT: Claude API translation completed in 24.63s
2025-12-29 21:14:11 - src.translator.processing - INFO - [translate_file_to_memory] Translated length: 3,623 characters
2025-12-29 21:14:11 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 3: SKIPPED (skip_memory=True) =====
2025-12-29 21:14:11 - src.translator.processing - INFO - [translate_file_to_memory] Translation memory disabled, not storing translation
2025-12-29 21:14:11 - src.translator.processing - INFO - [translate_file_to_memory] Translation complete: 24.63s
2025-12-29 21:14:11 - src.translator.processing - INFO - [translate_file_to_memory] Translated length: 3,623 characters
2025-12-29 21:14:11 - src.translator.processing - INFO - [translate_file_to_memory] Glossary enrichment: 0 terms highlighted (after filtering reference doc)
2025-12-29 21:14:11 - src.translator.processing - INFO - [translate_file_to_memory] Memory enrichment skipped (skip_memory=True)
2025-12-29 21:14:11 - src.translator.processing - INFO - [translate_file_to_memory] Generating PDF from 3 source paragraphs and 19 translated paragraphs
2025-12-29 21:14:11 - src.translator.pdf_writer - INFO - [write_pdf_to_bytes] Creating two-column layout with 3 source paragraphs and 19 translated paragraphs
2025-12-29 21:14:11 - src.translator.processing - INFO - [translate_file_to_memory] PDF generated: 6,131 bytes
2025-12-29 21:14:11 - src.translator.api - INFO - [TRANSLATION 26bb951c-5881-48ad-96ff-6d3cd3a0b50a] Translation complete
2025-12-29 21:14:11 - src.translator.api - INFO - [TRANSLATION 26bb951c-5881-48ad-96ff-6d3cd3a0b50a] PDF generated in memory: 6,131 bytes
2025-12-29 21:14:11 - src.translator.api - INFO - [TRANSLATION 26bb951c-5881-48ad-96ff-6d3cd3a0b50a] Original paragraphs: 3
2025-12-29 21:14:11 - src.translator.api - INFO - [TRANSLATION 26bb951c-5881-48ad-96ff-6d3cd3a0b50a] Translated paragraphs: 19
2025-12-29 21:14:11 - src.translator.api - INFO - [TRANSLATION 26bb951c-5881-48ad-96ff-6d3cd3a0b50a] Status updated to completed
2025-12-29 21:14:11 - src.translator.api - INFO - [TRANSLATION 26bb951c-5881-48ad-96ff-6d3cd3a0b50a] Final job hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:14:11 - src.translator.api - INFO - [TRANSLATION 26bb951c-5881-48ad-96ff-6d3cd3a0b50a] ===== TRANSLATION COMPLETE =====
2025-12-29 21:14:11 - src.translator.api - INFO - ================================================================================
2025-12-29 21:14:11 - src.translator.api - INFO - Job 26bb951c-5881-48ad-96ff-6d3cd3a0b50a: Cleaned up input file
INFO:     127.0.0.1:61209 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61211 - "GET /api/translate/26bb951c-5881-48ad-96ff-6d3cd3a0b50a/report HTTP/1.1" 200 OK
INFO:     127.0.0.1:61245 - "GET /api/user-role HTTP/1.1" 200 OK
2025-12-29 21:15:18 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:15:18 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:15:18 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:61247 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 21:15:18 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:15:18 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:15:18 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:61249 - "GET /api/prompt HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:61255 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'src/translator/api.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [96829]
2025-12-29 21:15:45 - src.translator.api - INFO - Logging initialized. Log file: /Users/enrico/workspace/translator/logs/backend.log
INFO:     Started server process [99385]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/translator/api.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [99385]
2025-12-29 21:16:04 - src.translator.api - INFO - Logging initialized. Log file: /Users/enrico/workspace/translator/logs/backend.log
INFO:     Started server process [99410]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
2025-12-29 21:16:19 - src.translator.api - INFO - Detected language: fr (prob: 1.00) -> fr
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:61284 - "POST /api/detect-language HTTP/1.1" 200 OK
2025-12-29 21:16:22 - src.translator.api - INFO - ================================================================================
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] ===== NEW TRANSLATION REQUEST =====
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] Timestamp: 1767039382.124305
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] File name: OBJET DU BAIL4.txt
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] Source: fr -> Target: it
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] File size: 129 bytes
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] First 200 bytes: b"\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse de l'immeuble: [\xc3\x80 compl\xc3\xa9ter]"
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] Use glossary: True
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] Using default glossary: glossary/glossary.csv
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] Generated job_id: c62e09b3-8ea4-4a5a-997b-4d8c3286a219
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: Created isolated input file: input_c62e09b3-8ea4-4a5a-997b-4d8c3286a219_p_2s3vxm.txt
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: File hash: 6c27678b16998564...
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219 stored in translation_jobs
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] Total active jobs: 1
2025-12-29 21:16:22 - src.translator.api - INFO - ================================================================================
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: Translation thread started
2025-12-29 21:16:22 - src.translator.api - INFO - [TRANSLATION c62e09b3-8ea4-4a5a-997b-4d8c3286a219] ===== STARTING TRANSLATION THREAD =====
2025-12-29 21:16:22 - src.translator.api - INFO - [REQUEST 2321d714] ===== REQUEST PROCESSING COMPLETE =====
2025-12-29 21:16:22 - src.translator.api - INFO - [TRANSLATION c62e09b3-8ea4-4a5a-997b-4d8c3286a219] Job data from storage:
2025-12-29 21:16:22 - src.translator.api - INFO - ================================================================================
2025-12-29 21:16:22 - src.translator.api - INFO - [TRANSLATION c62e09b3-8ea4-4a5a-997b-4d8c3286a219]   - File hash: 6c27678b169985646fa3b971e35c8042
INFO:     127.0.0.1:61286 - "POST /api/translate HTTP/1.1" 202 Accepted
2025-12-29 21:16:22 - src.translator.api - INFO - [TRANSLATION c62e09b3-8ea4-4a5a-997b-4d8c3286a219]   - Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_c62e09b3-8ea4-4a5a-997b-4d8c3286a219_p_2s3vxm.txt
2025-12-29 21:16:22 - src.translator.api - INFO - [TRANSLATION c62e09b3-8ea4-4a5a-997b-4d8c3286a219]   - Source: fr -> Target: it
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [FILE VERIFICATION] Opening file: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_c62e09b3-8ea4-4a5a-997b-4d8c3286a219_p_2s3vxm.txt
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [FILE VERIFICATION] File absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_c62e09b3-8ea4-4a5a-997b-4d8c3286a219_p_2s3vxm.txt
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [FILE VERIFICATION] File exists: True
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [FILE VERIFICATION] Read 129 bytes from file
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [FILE VERIFICATION] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [FILE VERIFICATION] Actual hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [FILE VERIFICATION] First 100 bytes: b'\n\n2. OBJET DU BAIL\n\n\xe2\x98\x90 Appartement de ______ pi\xc3\xa8ces  \n\xe2\x98\x90 ______ chambre(s) meubl\xc3\xa9e(s)\n\nAdresse d'
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [FILE VERIFICATION] Hash verified successfully
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [FILE VERIFICATION] File: input_c62e09b3-8ea4-4a5a-997b-4d8c3286a219_p_2s3vxm.txt, Size: 129 bytes
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: Created isolated temp directory: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/translation_c62e09b3-8ea4-4a5a-997b-4d8c3286a219_8eqxg45s
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: Loading glossary from glossary/glossary.csv (file will be read fresh)
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: Loaded glossary 'glossary' with 1350 entries
INFO:     127.0.0.1:61288 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: Using shared translation memory from /Users/enrico/workspace/translator/data/memory.json
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: Memory contains 202 existing records
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: Using role-specific prompt for role: '' (length: 0)
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [PRE-TRANSLATE] About to call translate_file_to_memory
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [PRE-TRANSLATE] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_c62e09b3-8ea4-4a5a-997b-4d8c3286a219_p_2s3vxm.txt
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [PRE-TRANSLATE] Input path absolute: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_c62e09b3-8ea4-4a5a-997b-4d8c3286a219_p_2s3vxm.txt
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [PRE-TRANSLATE] Input file exists: True
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [PRE-TRANSLATE] Final verification - Hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [PRE-TRANSLATE] Expected hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [PRE-TRANSLATE] File verified, calling translate_file_to_memory
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: [PRE-TRANSLATE] Source lang: fr, Target lang: it
2025-12-29 21:16:22 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: Stored 3 original paragraphs
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] ===== STARTING SINGLE-SHOT TRANSLATION =====
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] Input path: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_c62e09b3-8ea4-4a5a-997b-4d8c3286a219_p_2s3vxm.txt
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_c62e09b3-8ea4-4a5a-997b-4d8c3286a219_p_2s3vxm.txt
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] File size: 129 bytes
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] Reading entire file as text...
2025-12-29 21:16:22 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/input_c62e09b3-8ea4-4a5a-997b-4d8c3286a219_p_2s3vxm.txt
2025-12-29 21:16:22 - src.translator.processing - INFO - [_read_file_as_text] File type: .txt
2025-12-29 21:16:22 - src.translator.processing - INFO - [_read_file_as_text] File hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:16:22 - src.translator.processing - INFO - [_read_file_as_text] File size: 129 bytes
2025-12-29 21:16:22 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 121 characters
2025-12-29 21:16:22 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: 

2. OBJET DU BAIL

☐ Appartement de ______ pièces  
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À compléter]...
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] Looking up glossary matches...
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] Found 0 glossary matches (after filtering reference doc conflicts)
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 1: SKIPPED (skip_memory=True) =====
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] Translation memory disabled, proceeding directly to Claude API
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 2: QUERYING CLAUDE API =====
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] Sending entire document to Claude API (single call)
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] Document length: 121 characters
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] Glossary matches: 0
2025-12-29 21:16:22 - src.translator.processing - INFO - [translate_file_to_memory] Memory hits for context: 0
2025-12-29 21:16:22 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 21:16:22 - src.translator.claude_client - INFO - 🚀 CLAUDE API REQUEST - ENTIRE DOCUMENT (SINGLE SHOT)
2025-12-29 21:16:22 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 21:16:22 - src.translator.claude_client - INFO - Model: claude-sonnet-4-5-20250929
2025-12-29 21:16:22 - src.translator.claude_client - INFO - Max tokens: 8192
2025-12-29 21:16:22 - src.translator.claude_client - INFO - Document length: 121 characters
2025-12-29 21:16:22 - src.translator.claude_client - INFO - Total prompt length: 11,700 characters (~2,925 tokens)
2025-12-29 21:16:22 - src.translator.claude_client - INFO - Source language: fr -> Target language: it
2025-12-29 21:16:22 - src.translator.claude_client - INFO - Glossary entries: 0
2025-12-29 21:16:22 - src.translator.claude_client - INFO - Memory entries: 0
2025-12-29 21:16:22 - src.translator.claude_client - INFO - --------------------------------------------------------------------------------
2025-12-29 21:16:22 - src.translator.claude_client - INFO - 📝 DOCUMENT PREVIEW (first 500 chars):
2025-12-29 21:16:22 - src.translator.claude_client - INFO - 

2. OBJET DU BAIL

☐ Appartement de ______ pièces  
☐ ______ chambre(s) meublée(s)

Adresse de l'immeuble: [À compléter]...
2025-12-29 21:16:22 - src.translator.claude_client - INFO - --------------------------------------------------------------------------------
2025-12-29 21:16:22 - src.translator.claude_client - INFO - ⏱️  Sending entire document to Claude API in single call...
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:61292 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61294 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61296 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61298 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61300 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61302 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61304 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61308 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61310 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61312 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61315 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61317 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
2025-12-29 21:16:47 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-12-29 21:16:47 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 21:16:47 - src.translator.claude_client - INFO - ✅ CLAUDE API RESPONSE RECEIVED
2025-12-29 21:16:47 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 21:16:47 - src.translator.claude_client - INFO - ⏱️  Request duration: 24.77 seconds (0.41 minutes)
2025-12-29 21:16:47 - src.translator.claude_client - INFO - 📊 Response length: 3,623 characters
2025-12-29 21:16:47 - src.translator.claude_client - INFO - 📈 Token usage:
2025-12-29 21:16:47 - src.translator.claude_client - INFO -   - Input tokens: 3816
2025-12-29 21:16:47 - src.translator.claude_client - INFO -   - Output tokens: 1184
2025-12-29 21:16:47 - src.translator.claude_client - INFO - 📝 TRANSLATION PREVIEW (first 500 chars):
2025-12-29 21:16:47 - src.translator.claude_client - INFO - # TRADUZIONE

## 2. OGGETTO DELLA LOCAZIONE

☐ Appartamento di ______ locali  
☐ ______ camera/e ammobiliata/e

Indirizzo dell'immobile: [Da completare]

---

# TABELLA COMPARATIVA

| **Originale (FR)** | **Traduzione (IT)** | **Spiegazione** | **Fonte** |
|-------------------|---------------------|-----------------|-----------|
| OBJET DU BAIL | OGGETTO DELLA LOCAZIONE | In ambito locativo svizzero, "bail" si traduce sistematicamente con "locazione" (non "affitto"). Il termine è coerente con la...
2025-12-29 21:16:47 - src.translator.claude_client - INFO - ================================================================================
2025-12-29 21:16:47 - src.translator.processing - INFO - [translate_file_to_memory] ✅ STEP 2 RESULT: Claude API translation completed in 24.77s
2025-12-29 21:16:47 - src.translator.processing - INFO - [translate_file_to_memory] Translated length: 3,623 characters
2025-12-29 21:16:47 - src.translator.processing - INFO - [translate_file_to_memory] ===== STEP 3: SKIPPED (skip_memory=True) =====
2025-12-29 21:16:47 - src.translator.processing - INFO - [translate_file_to_memory] Translation memory disabled, not storing translation
2025-12-29 21:16:47 - src.translator.processing - INFO - [translate_file_to_memory] Translation complete: 24.77s
2025-12-29 21:16:47 - src.translator.processing - INFO - [translate_file_to_memory] Translated length: 3,623 characters
2025-12-29 21:16:47 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applying glossary: glossary
2025-12-29 21:16:47 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Translated text length: 3623
2025-12-29 21:16:47 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Applied 5 glossary terms
2025-12-29 21:16:47 - src.translator.glossary_enricher - INFO - [apply_glossary_with_highlighting] Breakdown: 5 translation matches, 0 source replacements
2025-12-29 21:16:47 - src.translator.processing - INFO - [translate_file_to_memory] Glossary enrichment: 5 terms highlighted (after filtering reference doc)
2025-12-29 21:16:47 - src.translator.processing - INFO - [translate_file_to_memory] Memory enrichment skipped (skip_memory=True)
2025-12-29 21:16:47 - src.translator.processing - INFO - [translate_file_to_memory] Generating PDF from 3 source paragraphs and 19 translated paragraphs
2025-12-29 21:16:47 - src.translator.pdf_writer - INFO - [write_pdf_to_bytes] Creating two-column layout with 3 source paragraphs and 19 translated paragraphs
2025-12-29 21:16:47 - src.translator.processing - INFO - [translate_file_to_memory] PDF generated: 6,209 bytes
2025-12-29 21:16:47 - src.translator.api - INFO - [TRANSLATION c62e09b3-8ea4-4a5a-997b-4d8c3286a219] Translation complete
2025-12-29 21:16:47 - src.translator.api - INFO - [TRANSLATION c62e09b3-8ea4-4a5a-997b-4d8c3286a219] PDF generated in memory: 6,209 bytes
2025-12-29 21:16:47 - src.translator.api - INFO - [TRANSLATION c62e09b3-8ea4-4a5a-997b-4d8c3286a219] Original paragraphs: 3
2025-12-29 21:16:47 - src.translator.api - INFO - [TRANSLATION c62e09b3-8ea4-4a5a-997b-4d8c3286a219] Translated paragraphs: 19
2025-12-29 21:16:47 - src.translator.api - INFO - [TRANSLATION c62e09b3-8ea4-4a5a-997b-4d8c3286a219] Status updated to completed
2025-12-29 21:16:47 - src.translator.api - INFO - [TRANSLATION c62e09b3-8ea4-4a5a-997b-4d8c3286a219] Final job hash: 6c27678b169985646fa3b971e35c8042
2025-12-29 21:16:47 - src.translator.api - INFO - [TRANSLATION c62e09b3-8ea4-4a5a-997b-4d8c3286a219] ===== TRANSLATION COMPLETE =====
2025-12-29 21:16:47 - src.translator.api - INFO - ================================================================================
2025-12-29 21:16:47 - src.translator.api - INFO - Job c62e09b3-8ea4-4a5a-997b-4d8c3286a219: Cleaned up input file
INFO:     127.0.0.1:61319 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:61321 - "GET /api/translate/c62e09b3-8ea4-4a5a-997b-4d8c3286a219/report HTTP/1.1" 200 OK
2025-12-29 21:17:04 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:17:04 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:17:04 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:61325 - "GET /api/prompt HTTP/1.1" 403 Forbidden
2025-12-29 21:17:04 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: translator, X-Username: translator1
2025-12-29 21:17:04 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: False
2025-12-29 21:17:04 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
INFO:     127.0.0.1:61327 - "GET /api/prompt HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:61329 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
: False
2025-12-29 21:17:04 - src.translator.api - WARNING - [PROMPT ACCESS] Access denied for user: translator1 (role: translator)
