INFO:     Will watch for changes in these directories: ['/Users/enrico/workspace/translator']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [98546] using WatchFiles
2026-01-03 17:58:24 - src.translator.api - INFO - Logging initialized. Log file: /Users/enrico/workspace/translator/logs/backend.log
INFO:     Started server process [98549]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
2026-01-03 17:58:56 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2026-01-03 17:58:56 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2026-01-03 17:58:56 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:58494 - "GET /api/prompt HTTP/1.1" 200 OK
2026-01-03 17:58:56 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2026-01-03 17:58:56 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2026-01-03 17:58:56 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:58495 - "GET /api/prompt HTTP/1.1" 200 OK
2026-01-03 17:59:09 - src.translator.api - INFO - Detected language: de (prob: 1.00) -> de
INFO:     127.0.0.1:58508 - "POST /api/detect-language HTTP/1.1" 200 OK
2026-01-03 17:59:34 - src.translator.api - INFO - [STREAM b5cd9f7e-ebb2-426c-b946-6ed1ebf5c91d] Starting streaming translation
2026-01-03 17:59:34 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmppja1rpk_.pdf
2026-01-03 17:59:34 - src.translator.processing - INFO - [_read_file_as_text] File type: .pdf
2026-01-03 17:59:34 - src.translator.processing - INFO - [_read_file_as_text] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 17:59:34 - src.translator.processing - INFO - [_read_file_as_text] File size: 187,007 bytes
2026-01-03 17:59:34 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 457 characters
2026-01-03 17:59:34 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
Kontow√§hrung: EUR
Kontoinhaber: Enrico Mariotti
Buchungstag: 2024-09-06
Umsatzart: √úberweisung
Erik I...
INFO:     127.0.0.1:58540 - "POST /api/translate-stream HTTP/1.1" 200 OK
2026-01-03 17:59:34 - src.translator.api - INFO - [STREAM a3479b07-8340-4fe5-9e95-922fce1ab529] Starting streaming translation
2026-01-03 17:59:34 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpx1lum855.pdf
2026-01-03 17:59:34 - src.translator.processing - INFO - [_read_file_as_text] File type: .pdf
2026-01-03 17:59:34 - src.translator.processing - INFO - [_read_file_as_text] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 17:59:34 - src.translator.processing - INFO - [_read_file_as_text] File size: 187,007 bytes
2026-01-03 17:59:34 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 457 characters
2026-01-03 17:59:34 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
Kontow√§hrung: EUR
Kontoinhaber: Enrico Mariotti
Buchungstag: 2024-09-06
Umsatzart: √úberweisung
Erik I...
INFO:     127.0.0.1:58543 - "POST /api/translate-stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58544 - "GET /api/translate/streaming/status HTTP/1.1" 404 Not Found
2026-01-03 17:59:36 - src.translator.api - INFO - [STREAM b5cd9f7e-ebb2-426c-b946-6ed1ebf5c91d] Generating PDF...
2026-01-03 17:59:36 - src.translator.pdf_writer - INFO - [write_pdf_to_bytes] Creating two-column layout with 1 source paragraphs and 18 translated paragraphs
2026-01-03 17:59:36 - src.translator.api - INFO - [STREAM b5cd9f7e-ebb2-426c-b946-6ed1ebf5c91d] PDF generated: 7,791 bytes
2026-01-03 17:59:36 - src.translator.api - INFO - [STREAM b5cd9f7e-ebb2-426c-b946-6ed1ebf5c91d] PDF stored for download
2026-01-03 17:59:36 - src.translator.api - INFO - [STREAM a3479b07-8340-4fe5-9e95-922fce1ab529] Generating PDF...
2026-01-03 17:59:36 - src.translator.pdf_writer - INFO - [write_pdf_to_bytes] Creating two-column layout with 1 source paragraphs and 18 translated paragraphs
2026-01-03 17:59:36 - src.translator.api - INFO - [STREAM a3479b07-8340-4fe5-9e95-922fce1ab529] PDF generated: 7,791 bytes
2026-01-03 17:59:36 - src.translator.api - INFO - [STREAM a3479b07-8340-4fe5-9e95-922fce1ab529] PDF stored for download
INFO:     127.0.0.1:58546 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
INFO:     127.0.0.1:58548 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
2026-01-03 17:59:39 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2026-01-03 17:59:39 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2026-01-03 17:59:39 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:58555 - "GET /api/prompt HTTP/1.1" 200 OK
2026-01-03 17:59:39 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2026-01-03 17:59:39 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2026-01-03 17:59:39 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:58557 - "GET /api/prompt HTTP/1.1" 200 OK
2026-01-03 17:59:45 - src.translator.api - INFO - Detected language: de (prob: 1.00) -> de
INFO:     127.0.0.1:58562 - "POST /api/detect-language HTTP/1.1" 200 OK
2026-01-03 18:00:02 - src.translator.api - INFO - [STREAM cfa46537-33b1-46e6-ade4-fc8a4f862add] Starting streaming translation
2026-01-03 18:00:02 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpm8ybnqfq.pdf
2026-01-03 18:00:02 - src.translator.processing - INFO - [_read_file_as_text] File type: .pdf
2026-01-03 18:00:02 - src.translator.processing - INFO - [_read_file_as_text] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:00:02 - src.translator.processing - INFO - [_read_file_as_text] File size: 187,007 bytes
2026-01-03 18:00:02 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 457 characters
2026-01-03 18:00:02 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
Kontow√§hrung: EUR
Kontoinhaber: Enrico Mariotti
Buchungstag: 2024-09-06
Umsatzart: √úberweisung
Erik I...
INFO:     127.0.0.1:58580 - "POST /api/translate-stream HTTP/1.1" 200 OK
INFO:     127.0.0.1:58583 - "GET /api/translate/streaming/status HTTP/1.1" 404 Not Found
2026-01-03 18:00:02 - src.translator.api - INFO - [STREAM 2c843aff-2425-48dc-801a-d044fae41417] Starting streaming translation
2026-01-03 18:00:02 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp71w91bwk.pdf
2026-01-03 18:00:02 - src.translator.processing - INFO - [_read_file_as_text] File type: .pdf
2026-01-03 18:00:02 - src.translator.processing - INFO - [_read_file_as_text] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:00:02 - src.translator.processing - INFO - [_read_file_as_text] File size: 187,007 bytes
2026-01-03 18:00:02 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 457 characters
2026-01-03 18:00:02 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
Kontow√§hrung: EUR
Kontoinhaber: Enrico Mariotti
Buchungstag: 2024-09-06
Umsatzart: √úberweisung
Erik I...
INFO:     127.0.0.1:58584 - "POST /api/translate-stream HTTP/1.1" 200 OK
2026-01-03 18:00:03 - src.translator.api - INFO - [STREAM cfa46537-33b1-46e6-ade4-fc8a4f862add] Generating PDF...
2026-01-03 18:00:03 - src.translator.api - INFO - [STREAM cfa46537-33b1-46e6-ade4-fc8a4f862add] Using PyMuPDF to preserve PDF formatting
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Translating PDF with formatting preservation
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Input: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpm8ybnqfq.pdf
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Output: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpii2foeeo.pdf
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Number of translated paragraphs: 18
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Reading PDF: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpm8ybnqfq.pdf
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpm8ybnqfq.pdf
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File size: 187,007 bytes
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] PDF opened, pages: 1
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] First page first chunk: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
K...
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Extracted 1 paragraphs
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Extracted 1 original paragraphs from PDF
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Paragraph count mismatch: 1 original vs 18 translated
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Will attempt to map paragraphs by position
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Opened PDF with 1 pages
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Processing page 1
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Found 11 paragraph groups
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Starting with translation_idx=0, total translations=18
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Re-inserting 11 translated paragraphs
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 0: '# TRADUZIONE...' (font: Arial, size: 14.0)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-7.8), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 1: '## Testo tradotto...' (font: Arial Bold, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-3.4), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 2: '**Dettagli delle transazioni**  
www.commerzbank.d...' (font: Arial Bold, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-189.6), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 3: '---...' (font: Arial, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-3.6), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 4: '## TABELLA COMPARATIVA E NOTE...' (font: Arial, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-3.6), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 5: '| **Originale (DE)** | **Traduzione (IT)** | **Spi...' (font: Arial, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-457.0), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 6: '---...' (font: Arial, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-2.6), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 7: '## NOTE METODOLOGICHE E CONTESTUALI...' (font: Arial, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_textbox (rc=5.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 8: '### 1. **Natura del documento**
Questo √® un **estr...' (font: Arial, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-94.9), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 9: '### 2. **Scelte terminologiche bancarie**
- **"Ums...' (font: Arial Bold, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-138.0), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 10: '### 3. **Elementi invariati**
- **IBAN, BIC, codic...' (font: Arial, size: 6.0)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-1042.2), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Saved translated PDF with preserved formatting to /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpii2foeeo.pdf
2026-01-03 18:00:03 - src.translator.api - INFO - [STREAM cfa46537-33b1-46e6-ade4-fc8a4f862add] PDF generated with formatting preservation: 197,189 bytes
2026-01-03 18:00:03 - src.translator.api - INFO - [STREAM cfa46537-33b1-46e6-ade4-fc8a4f862add] PDF stored for download
2026-01-03 18:00:03 - src.translator.api - INFO - [STREAM 2c843aff-2425-48dc-801a-d044fae41417] Generating PDF...
2026-01-03 18:00:03 - src.translator.api - INFO - [STREAM 2c843aff-2425-48dc-801a-d044fae41417] Using PyMuPDF to preserve PDF formatting
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Translating PDF with formatting preservation
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Input: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp71w91bwk.pdf
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Output: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp1eooek80.pdf
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Number of translated paragraphs: 18
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Reading PDF: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp71w91bwk.pdf
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp71w91bwk.pdf
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File size: 187,007 bytes
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] PDF opened, pages: 1
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] First page first chunk: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
K...
2026-01-03 18:00:03 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Extracted 1 paragraphs
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Extracted 1 original paragraphs from PDF
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Paragraph count mismatch: 1 original vs 18 translated
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Will attempt to map paragraphs by position
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Opened PDF with 1 pages
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Processing page 1
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Found 11 paragraph groups
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Starting with translation_idx=0, total translations=18
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Re-inserting 11 translated paragraphs
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 0: '# TRADUZIONE...' (font: Arial, size: 14.0)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-7.8), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 1: '## Testo tradotto...' (font: Arial Bold, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-3.4), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 2: '**Dettagli delle transazioni**  
www.commerzbank.d...' (font: Arial Bold, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-189.6), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 3: '---...' (font: Arial, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-3.6), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 4: '## TABELLA COMPARATIVA E NOTE...' (font: Arial, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-3.6), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 5: '| **Originale (DE)** | **Traduzione (IT)** | **Spi...' (font: Arial, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-457.0), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 6: '---...' (font: Arial, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-2.6), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 7: '## NOTE METODOLOGICHE E CONTESTUALI...' (font: Arial, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_textbox (rc=5.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 8: '### 1. **Natura del documento**
Questo √® un **estr...' (font: Arial, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-94.9), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 9: '### 2. **Scelte terminologiche bancarie**
- **"Ums...' (font: Arial Bold, size: 7.5)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-138.0), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 10: '### 3. **Elementi invariati**
- **IBAN, BIC, codic...' (font: Arial, size: 6.0)
2026-01-03 18:00:03 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-1042.2), trying insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:00:03 - src.translator.pdf_formatter - INFO - Saved translated PDF with preserved formatting to /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp1eooek80.pdf
2026-01-03 18:00:03 - src.translator.api - INFO - [STREAM 2c843aff-2425-48dc-801a-d044fae41417] PDF generated with formatting preservation: 197,189 bytes
2026-01-03 18:00:03 - src.translator.api - INFO - [STREAM 2c843aff-2425-48dc-801a-d044fae41417] PDF stored for download
INFO:     127.0.0.1:58591 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
INFO:     127.0.0.1:58593 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
2026-01-03 18:00:19 - src.translator.api - INFO - [DOWNLOAD STREAM 2c843aff-2425-48dc-801a-d044fae41417] Serving PDF from memory: 197,189 bytes
INFO:     127.0.0.1:58606 - "GET /api/translate-stream/2c843aff-2425-48dc-801a-d044fae41417/download HTTP/1.1" 200 OK
2026-01-03 18:07:05 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2026-01-03 18:07:05 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2026-01-03 18:07:05 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:59127 - "GET /api/prompt HTTP/1.1" 200 OK
2026-01-03 18:07:05 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2026-01-03 18:07:05 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2026-01-03 18:07:05 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:59129 - "GET /api/prompt HTTP/1.1" 200 OK
2026-01-03 18:07:11 - src.translator.api - INFO - Detected language: de (prob: 1.00) -> de
INFO:     127.0.0.1:59137 - "POST /api/detect-language HTTP/1.1" 200 OK
INFO:     127.0.0.1:59161 - "GET /api/translate/streaming/status HTTP/1.1" 404 Not Found
2026-01-03 18:07:31 - src.translator.api - INFO - [STREAM f4c76063-ef09-4974-abe4-55ed3d66046e] Starting streaming translation
2026-01-03 18:07:31 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpfv3shtjc.pdf
2026-01-03 18:07:31 - src.translator.processing - INFO - [_read_file_as_text] File type: .pdf
2026-01-03 18:07:31 - src.translator.processing - INFO - [_read_file_as_text] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:07:31 - src.translator.processing - INFO - [_read_file_as_text] File size: 187,007 bytes
2026-01-03 18:07:31 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 457 characters
2026-01-03 18:07:31 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
Kontow√§hrung: EUR
Kontoinhaber: Enrico Mariotti
Buchungstag: 2024-09-06
Umsatzart: √úberweisung
Erik I...
2026-01-03 18:07:31 - src.translator.api - INFO - [STREAM 8ffabba2-32c7-49a3-8ff1-b4fe7f244e2c] Starting streaming translation
2026-01-03 18:07:31 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp2aqn4mq1.pdf
2026-01-03 18:07:31 - src.translator.processing - INFO - [_read_file_as_text] File type: .pdf
2026-01-03 18:07:31 - src.translator.processing - INFO - [_read_file_as_text] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:07:31 - src.translator.processing - INFO - [_read_file_as_text] File size: 187,007 bytes
2026-01-03 18:07:31 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 457 characters
2026-01-03 18:07:31 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
Kontow√§hrung: EUR
Kontoinhaber: Enrico Mariotti
Buchungstag: 2024-09-06
Umsatzart: √úberweisung
Erik I...
INFO:     127.0.0.1:59158 - "POST /api/translate-stream HTTP/1.1" 200 OK
2026-01-03 18:07:31 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:07:31 - src.translator.claude_client - INFO - üîÑ STREAMING CLAUDE API REQUEST
2026-01-03 18:07:31 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:07:31 - src.translator.claude_client - INFO - üìä Document details:
2026-01-03 18:07:31 - src.translator.claude_client - INFO -   - Document length: 457 characters
2026-01-03 18:07:31 - src.translator.claude_client - INFO -   - Source: de -> Target: it
2026-01-03 18:07:31 - src.translator.claude_client - INFO -   - Glossary matches: 1
2026-01-03 18:07:31 - src.translator.claude_client - INFO -   - Memory hits: 0
2026-01-03 18:07:31 - src.translator.claude_client - INFO -   - Reference doc pairs: 0
2026-01-03 18:07:31 - src.translator.claude_client - INFO - üìè Prompt details:
2026-01-03 18:07:31 - src.translator.claude_client - INFO -   - Total prompt length: 997 characters (~249 tokens)
2026-01-03 18:07:31 - src.translator.claude_client - INFO - üéØ Model: claude-sonnet-4-5-20250929
2026-01-03 18:07:31 - src.translator.claude_client - INFO - ‚è±Ô∏è  Starting streaming translation...
2026-01-03 18:07:31 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:07:33 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:     127.0.0.1:59162 - "POST /api/translate-stream HTTP/1.1" 200 OK
2026-01-03 18:07:33 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:07:33 - src.translator.claude_client - INFO - üîÑ STREAMING CLAUDE API REQUEST
2026-01-03 18:07:33 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:07:33 - src.translator.claude_client - INFO - üìä Document details:
2026-01-03 18:07:33 - src.translator.claude_client - INFO -   - Document length: 457 characters
2026-01-03 18:07:33 - src.translator.claude_client - INFO -   - Source: de -> Target: it
2026-01-03 18:07:33 - src.translator.claude_client - INFO -   - Glossary matches: 1
2026-01-03 18:07:33 - src.translator.claude_client - INFO -   - Memory hits: 0
2026-01-03 18:07:33 - src.translator.claude_client - INFO -   - Reference doc pairs: 0
2026-01-03 18:07:33 - src.translator.claude_client - INFO - üìè Prompt details:
2026-01-03 18:07:33 - src.translator.claude_client - INFO -   - Total prompt length: 997 characters (~249 tokens)
2026-01-03 18:07:33 - src.translator.claude_client - INFO - üéØ Model: claude-sonnet-4-5-20250929
2026-01-03 18:07:33 - src.translator.claude_client - INFO - ‚è±Ô∏è  Starting streaming translation...
2026-01-03 18:07:33 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:07:35 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2026-01-03 18:07:38 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:07:38 - src.translator.claude_client - INFO - ‚úÖ CLAUDE API STREAMING COMPLETED
2026-01-03 18:07:38 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:07:38 - src.translator.claude_client - INFO - ‚è±Ô∏è  Total duration: 6.93 seconds
2026-01-03 18:07:38 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:07:38 - src.translator.api - INFO - [STREAM f4c76063-ef09-4974-abe4-55ed3d66046e] Generating PDF...
2026-01-03 18:07:38 - src.translator.api - INFO - [STREAM f4c76063-ef09-4974-abe4-55ed3d66046e] Using PyMuPDF to preserve PDF formatting
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Translating PDF with formatting preservation
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Input: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpfv3shtjc.pdf
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Output: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp_8mtenac.pdf
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Number of translated paragraphs: 2
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Reading PDF: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpfv3shtjc.pdf
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpfv3shtjc.pdf
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File size: 187,007 bytes
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] PDF opened, pages: 1
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] First page first chunk: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
K...
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Extracted 1 paragraphs
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Extracted 1 original paragraphs from PDF
2026-01-03 18:07:38 - src.translator.pdf_formatter - WARNING - Paragraph count mismatch: 1 original vs 2 translated
2026-01-03 18:07:38 - src.translator.pdf_formatter - WARNING - Will attempt to map paragraphs by position
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Opened PDF with 1 pages
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Processing page 1
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Found 11 paragraph groups
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Starting with translation_idx=0, total translations=2
2026-01-03 18:07:38 - src.translator.pdf_formatter - WARNING - Page 1: Ran out of translations at index 2
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Re-inserting 2 translated paragraphs
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 0: '# Traduzione in italiano...' (font: Arial, size: 14.0)
2026-01-03 18:07:38 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-7.8), trying insert_text
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 1: '## Dettagli della transazione
www.commerzbank.de
I...' (font: Arial Bold, size: 7.5)
2026-01-03 18:07:38 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-148.0), trying insert_text
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Saved translated PDF with preserved formatting to /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp_8mtenac.pdf
2026-01-03 18:07:38 - src.translator.api - INFO - [STREAM f4c76063-ef09-4974-abe4-55ed3d66046e] PDF generated with formatting preservation: 192,504 bytes
2026-01-03 18:07:38 - src.translator.api - INFO - [STREAM f4c76063-ef09-4974-abe4-55ed3d66046e] PDF stored for download
2026-01-03 18:07:38 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:07:38 - src.translator.claude_client - INFO - ‚úÖ CLAUDE API STREAMING COMPLETED
2026-01-03 18:07:38 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:07:38 - src.translator.claude_client - INFO - ‚è±Ô∏è  Total duration: 4.93 seconds
2026-01-03 18:07:38 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:07:38 - src.translator.api - INFO - [STREAM 8ffabba2-32c7-49a3-8ff1-b4fe7f244e2c] Generating PDF...
2026-01-03 18:07:38 - src.translator.api - INFO - [STREAM 8ffabba2-32c7-49a3-8ff1-b4fe7f244e2c] Using PyMuPDF to preserve PDF formatting
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Translating PDF with formatting preservation
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Input: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp2aqn4mq1.pdf
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Output: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpiuop3inu.pdf
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Number of translated paragraphs: 2
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Reading PDF: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp2aqn4mq1.pdf
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp2aqn4mq1.pdf
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File size: 187,007 bytes
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] PDF opened, pages: 1
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] First page first chunk: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
K...
2026-01-03 18:07:38 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Extracted 1 paragraphs
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Extracted 1 original paragraphs from PDF
2026-01-03 18:07:38 - src.translator.pdf_formatter - WARNING - Paragraph count mismatch: 1 original vs 2 translated
2026-01-03 18:07:38 - src.translator.pdf_formatter - WARNING - Will attempt to map paragraphs by position
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Opened PDF with 1 pages
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Processing page 1
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Found 11 paragraph groups
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Starting with translation_idx=0, total translations=2
2026-01-03 18:07:38 - src.translator.pdf_formatter - WARNING - Page 1: Ran out of translations at index 2
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Re-inserting 2 translated paragraphs
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 0: '# Traduzione in italiano...' (font: Arial, size: 14.0)
2026-01-03 18:07:38 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-7.8), trying insert_text
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 1: '## Dettagli della transazione
www.commerzbank.de
I...' (font: Arial Bold, size: 7.5)
2026-01-03 18:07:38 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-148.0), trying insert_text
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:07:38 - src.translator.pdf_formatter - INFO - Saved translated PDF with preserved formatting to /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpiuop3inu.pdf
2026-01-03 18:07:38 - src.translator.api - INFO - [STREAM 8ffabba2-32c7-49a3-8ff1-b4fe7f244e2c] PDF generated with formatting preservation: 192,504 bytes
2026-01-03 18:07:38 - src.translator.api - INFO - [STREAM 8ffabba2-32c7-49a3-8ff1-b4fe7f244e2c] PDF stored for download
INFO:     127.0.0.1:59173 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
INFO:     127.0.0.1:59175 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
2026-01-03 18:07:45 - src.translator.api - INFO - [DOWNLOAD STREAM f4c76063-ef09-4974-abe4-55ed3d66046e] Serving PDF from memory: 192,504 bytes
INFO:     127.0.0.1:59186 - "GET /api/translate-stream/f4c76063-ef09-4974-abe4-55ed3d66046e/download HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'src/translator/pdf_formatter.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [98549]
2026-01-03 18:10:37 - src.translator.api - INFO - Logging initialized. Log file: /Users/enrico/workspace/translator/logs/backend.log
INFO:     Started server process [99438]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'src/translator/pdf_formatter.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [99438]
2026-01-03 18:10:51 - src.translator.api - INFO - Logging initialized. Log file: /Users/enrico/workspace/translator/logs/backend.log
INFO:     Started server process [99448]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
2026-01-03 18:53:02 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2026-01-03 18:53:02 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2026-01-03 18:53:02 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:62569 - "GET /api/prompt HTTP/1.1" 200 OK
2026-01-03 18:53:02 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2026-01-03 18:53:02 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2026-01-03 18:53:02 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:62570 - "GET /api/prompt HTTP/1.1" 200 OK
2026-01-03 18:53:14 - src.translator.api - INFO - Detected language: de (prob: 1.00) -> de
INFO:     127.0.0.1:62582 - "POST /api/detect-language HTTP/1.1" 200 OK
2026-01-03 18:53:23 - src.translator.api - INFO - [STREAM 43f09c7b-bda9-4cad-9131-2f4d1f20f3e9] Starting streaming translation
2026-01-03 18:53:23 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpsfgwkvts.pdf
2026-01-03 18:53:23 - src.translator.processing - INFO - [_read_file_as_text] File type: .pdf
2026-01-03 18:53:23 - src.translator.processing - INFO - [_read_file_as_text] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:53:23 - src.translator.processing - INFO - [_read_file_as_text] File size: 187,007 bytes
2026-01-03 18:53:23 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 457 characters
2026-01-03 18:53:23 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
Kontow√§hrung: EUR
Kontoinhaber: Enrico Mariotti
Buchungstag: 2024-09-06
Umsatzart: √úberweisung
Erik I...
INFO:     127.0.0.1:62603 - "POST /api/translate-stream HTTP/1.1" 200 OK
2026-01-03 18:53:23 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:53:23 - src.translator.claude_client - INFO - üîÑ STREAMING CLAUDE API REQUEST
2026-01-03 18:53:23 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:53:23 - src.translator.claude_client - INFO - üìä Document details:
2026-01-03 18:53:23 - src.translator.claude_client - INFO -   - Document length: 457 characters
2026-01-03 18:53:23 - src.translator.claude_client - INFO -   - Source: de -> Target: it
2026-01-03 18:53:23 - src.translator.claude_client - INFO -   - Glossary matches: 1
2026-01-03 18:53:23 - src.translator.claude_client - INFO -   - Memory hits: 0
2026-01-03 18:53:23 - src.translator.claude_client - INFO -   - Reference doc pairs: 0
2026-01-03 18:53:23 - src.translator.claude_client - INFO - üìè Prompt details:
2026-01-03 18:53:23 - src.translator.claude_client - INFO -   - Total prompt length: 12,364 characters (~3,091 tokens)
2026-01-03 18:53:23 - src.translator.claude_client - INFO - üéØ Model: claude-sonnet-4-5-20250929
2026-01-03 18:53:23 - src.translator.claude_client - INFO - ‚è±Ô∏è  Starting streaming translation...
2026-01-03 18:53:23 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:53:25 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:     127.0.0.1:62606 - "GET /api/translate/streaming/status HTTP/1.1" 404 Not Found
2026-01-03 18:53:26 - src.translator.api - INFO - [STREAM 58d308f7-58f9-4fee-86d0-7cff92af13b8] Starting streaming translation
2026-01-03 18:53:26 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmphxwp7a06.pdf
2026-01-03 18:53:26 - src.translator.processing - INFO - [_read_file_as_text] File type: .pdf
2026-01-03 18:53:26 - src.translator.processing - INFO - [_read_file_as_text] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:53:26 - src.translator.processing - INFO - [_read_file_as_text] File size: 187,007 bytes
2026-01-03 18:53:26 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 457 characters
2026-01-03 18:53:26 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
Kontow√§hrung: EUR
Kontoinhaber: Enrico Mariotti
Buchungstag: 2024-09-06
Umsatzart: √úberweisung
Erik I...
INFO:     127.0.0.1:62607 - "POST /api/translate-stream HTTP/1.1" 200 OK
2026-01-03 18:53:26 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:53:26 - src.translator.claude_client - INFO - üîÑ STREAMING CLAUDE API REQUEST
2026-01-03 18:53:26 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:53:26 - src.translator.claude_client - INFO - üìä Document details:
2026-01-03 18:53:26 - src.translator.claude_client - INFO -   - Document length: 457 characters
2026-01-03 18:53:26 - src.translator.claude_client - INFO -   - Source: de -> Target: it
2026-01-03 18:53:26 - src.translator.claude_client - INFO -   - Glossary matches: 1
2026-01-03 18:53:26 - src.translator.claude_client - INFO -   - Memory hits: 0
2026-01-03 18:53:26 - src.translator.claude_client - INFO -   - Reference doc pairs: 0
2026-01-03 18:53:26 - src.translator.claude_client - INFO - üìè Prompt details:
2026-01-03 18:53:26 - src.translator.claude_client - INFO -   - Total prompt length: 12,364 characters (~3,091 tokens)
2026-01-03 18:53:26 - src.translator.claude_client - INFO - üéØ Model: claude-sonnet-4-5-20250929
2026-01-03 18:53:26 - src.translator.claude_client - INFO - ‚è±Ô∏è  Starting streaming translation...
2026-01-03 18:53:26 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:53:28 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2026-01-03 18:53:56 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:53:56 - src.translator.claude_client - INFO - ‚úÖ CLAUDE API STREAMING COMPLETED
2026-01-03 18:53:56 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:53:56 - src.translator.claude_client - INFO - ‚è±Ô∏è  Total duration: 33.09 seconds
2026-01-03 18:53:56 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:53:56 - src.translator.api - INFO - [STREAM 43f09c7b-bda9-4cad-9131-2f4d1f20f3e9] Generating PDF...
2026-01-03 18:53:56 - src.translator.api - INFO - [STREAM 43f09c7b-bda9-4cad-9131-2f4d1f20f3e9] Using PyMuPDF to preserve PDF formatting
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Translating PDF with formatting preservation
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Input: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpsfgwkvts.pdf
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Output: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpgnnjb_xf.pdf
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Number of translated paragraphs: 18
2026-01-03 18:53:56 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Reading PDF: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpsfgwkvts.pdf
2026-01-03 18:53:56 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpsfgwkvts.pdf
2026-01-03 18:53:56 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:53:56 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File size: 187,007 bytes
2026-01-03 18:53:56 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] PDF opened, pages: 1
2026-01-03 18:53:56 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] First page first chunk: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
K...
2026-01-03 18:53:56 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Extracted 1 paragraphs
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Extracted 1 original paragraphs from PDF
2026-01-03 18:53:56 - src.translator.pdf_formatter - WARNING - Paragraph count mismatch: 1 original vs 18 translated
2026-01-03 18:53:56 - src.translator.pdf_formatter - WARNING - Will attempt to map paragraphs by position
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Opened PDF with 1 pages
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Processing page 1
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Found 11 paragraph groups
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Starting with translation_idx=0, total translations=18
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Redacting all text spans to remove original text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Will replace 11 paragraphs with translations
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Re-inserting 11 translated paragraphs
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 0: '# TRADUZIONE...' (font: Arial, size: 14.0)
2026-01-03 18:53:56 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-7.8), trying insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 1: '## Testo tradotto...' (font: Arial Bold, size: 7.5)
2026-01-03 18:53:56 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-3.4), trying insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 2: '**Dettagli delle transazioni**  
www.commerzbank.d...' (font: Arial Bold, size: 7.5)
2026-01-03 18:53:56 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-189.6), trying insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 3: '---...' (font: Arial, size: 7.5)
2026-01-03 18:53:56 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-3.6), trying insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 4: '## TABELLA COMPARATIVA E NOTE...' (font: Arial, size: 7.5)
2026-01-03 18:53:56 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-3.6), trying insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 5: '| **Originale (DE)** | **Traduzione (IT)** | **Spi...' (font: Arial, size: 7.5)
2026-01-03 18:53:56 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-488.0), trying insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 6: '---...' (font: Arial, size: 7.5)
2026-01-03 18:53:56 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-2.6), trying insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 7: '## NOTE METODOLOGICHE E CONTESTUALI...' (font: Arial, size: 7.5)
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_textbox (rc=5.5)
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 8: '### 1. **Natura del documento**
Questo √® un **estr...' (font: Arial, size: 7.5)
2026-01-03 18:53:56 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-105.2), trying insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 9: '### 2. **Scelte terminologiche bancarie**
La termi...' (font: Arial Bold, size: 7.5)
2026-01-03 18:53:56 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-96.6), trying insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 10: '### 3. **Elemento di incertezza: "Adresse Baustell...' (font: Arial, size: 6.0)
2026-01-03 18:53:56 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-1528.6), trying insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:53:56 - src.translator.pdf_formatter - INFO - Saved translated PDF with preserved formatting to /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpgnnjb_xf.pdf
2026-01-03 18:53:56 - src.translator.api - INFO - [STREAM 43f09c7b-bda9-4cad-9131-2f4d1f20f3e9] PDF generated with formatting preservation: 203,253 bytes
2026-01-03 18:53:56 - src.translator.api - INFO - [STREAM 43f09c7b-bda9-4cad-9131-2f4d1f20f3e9] PDF stored for download
INFO:     127.0.0.1:62673 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
INFO:     127.0.0.1:62675 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
2026-01-03 18:54:01 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:54:01 - src.translator.claude_client - INFO - ‚úÖ CLAUDE API STREAMING COMPLETED
2026-01-03 18:54:01 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:54:01 - src.translator.claude_client - INFO - ‚è±Ô∏è  Total duration: 35.51 seconds
2026-01-03 18:54:01 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:54:01 - src.translator.api - INFO - [STREAM 58d308f7-58f9-4fee-86d0-7cff92af13b8] Generating PDF...
2026-01-03 18:54:01 - src.translator.api - INFO - [STREAM 58d308f7-58f9-4fee-86d0-7cff92af13b8] Using PyMuPDF to preserve PDF formatting
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Translating PDF with formatting preservation
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Input: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmphxwp7a06.pdf
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Output: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmppig1x8jc.pdf
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Number of translated paragraphs: 18
2026-01-03 18:54:01 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Reading PDF: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmphxwp7a06.pdf
2026-01-03 18:54:01 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmphxwp7a06.pdf
2026-01-03 18:54:01 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:54:01 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File size: 187,007 bytes
2026-01-03 18:54:01 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] PDF opened, pages: 1
2026-01-03 18:54:01 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] First page first chunk: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
K...
2026-01-03 18:54:01 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Extracted 1 paragraphs
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Extracted 1 original paragraphs from PDF
2026-01-03 18:54:01 - src.translator.pdf_formatter - WARNING - Paragraph count mismatch: 1 original vs 18 translated
2026-01-03 18:54:01 - src.translator.pdf_formatter - WARNING - Will attempt to map paragraphs by position
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Opened PDF with 1 pages
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Processing page 1
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Found 11 paragraph groups
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Starting with translation_idx=0, total translations=18
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Redacting all text spans to remove original text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Will replace 11 paragraphs with translations
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Re-inserting 11 translated paragraphs
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 0: '# TRADUZIONE...' (font: Arial, size: 14.0)
2026-01-03 18:54:01 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-7.8), trying insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 1: '## Testo tradotto...' (font: Arial Bold, size: 7.5)
2026-01-03 18:54:01 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-3.4), trying insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 2: '**Dettagli delle transazioni**  
www.commerzbank.d...' (font: Arial Bold, size: 7.5)
2026-01-03 18:54:01 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-189.6), trying insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 3: '---...' (font: Arial, size: 7.5)
2026-01-03 18:54:01 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-3.6), trying insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 4: '## TABELLA COMPARATIVA E NOTE...' (font: Arial, size: 7.5)
2026-01-03 18:54:01 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-3.6), trying insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 5: '| **Originale (DE)** | **Traduzione (IT)** | **Spi...' (font: Arial, size: 7.5)
2026-01-03 18:54:01 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-457.0), trying insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 6: '---...' (font: Arial, size: 7.5)
2026-01-03 18:54:01 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-2.6), trying insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 7: '## NOTE METODOLOGICHE E CONTESTUALI...' (font: Arial, size: 7.5)
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_textbox (rc=5.5)
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 8: '### 1. **Natura del documento**
Questo √® un **estr...' (font: Arial, size: 7.5)
2026-01-03 18:54:01 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-94.9), trying insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 9: '### 2. **Scelte terminologiche bancarie**
- **"Ums...' (font: Arial Bold, size: 7.5)
2026-01-03 18:54:01 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-138.0), trying insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 10: '### 3. **Elementi invariati**
- **IBAN, BIC, codic...' (font: Arial, size: 6.0)
2026-01-03 18:54:01 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-1042.2), trying insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:54:01 - src.translator.pdf_formatter - INFO - Saved translated PDF with preserved formatting to /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmppig1x8jc.pdf
2026-01-03 18:54:01 - src.translator.api - INFO - [STREAM 58d308f7-58f9-4fee-86d0-7cff92af13b8] PDF generated with formatting preservation: 203,211 bytes
2026-01-03 18:54:01 - src.translator.api - INFO - [STREAM 58d308f7-58f9-4fee-86d0-7cff92af13b8] PDF stored for download
2026-01-03 18:54:02 - src.translator.api - INFO - [DOWNLOAD STREAM 58d308f7-58f9-4fee-86d0-7cff92af13b8] Serving PDF from memory: 203,211 bytes
INFO:     127.0.0.1:62680 - "GET /api/translate-stream/58d308f7-58f9-4fee-86d0-7cff92af13b8/download HTTP/1.1" 200 OK
2026-01-03 18:54:32 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2026-01-03 18:54:32 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2026-01-03 18:54:32 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:62714 - "GET /api/prompt HTTP/1.1" 200 OK
2026-01-03 18:54:32 - src.translator.api - INFO - [PROMPT ACCESS] X-User-Role: admin, X-Username: admin
2026-01-03 18:54:32 - src.translator.api - INFO - [PROMPT ACCESS] Admin check result: True
2026-01-03 18:54:32 - src.translator.api - INFO - [PROMPT ACCESS] Access granted for admin user: admin
[prompt] Loaded custom prompt template from /Users/enrico/workspace/translator/prompt.md
INFO:     127.0.0.1:62716 - "GET /api/prompt HTTP/1.1" 200 OK
2026-01-03 18:54:52 - src.translator.api - INFO - Detected language: de (prob: 1.00) -> de
INFO:     127.0.0.1:62738 - "POST /api/detect-language HTTP/1.1" 200 OK
2026-01-03 18:54:58 - src.translator.api - INFO - [STREAM 271fd657-df81-424e-b650-e885c2e1ebe9] Starting streaming translation
2026-01-03 18:54:58 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpovc6z2m7.pdf
2026-01-03 18:54:58 - src.translator.processing - INFO - [_read_file_as_text] File type: .pdf
2026-01-03 18:54:58 - src.translator.processing - INFO - [_read_file_as_text] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:54:58 - src.translator.processing - INFO - [_read_file_as_text] File size: 187,007 bytes
2026-01-03 18:54:58 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 457 characters
2026-01-03 18:54:58 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
Kontow√§hrung: EUR
Kontoinhaber: Enrico Mariotti
Buchungstag: 2024-09-06
Umsatzart: √úberweisung
Erik I...
INFO:     127.0.0.1:62747 - "POST /api/translate-stream HTTP/1.1" 200 OK
2026-01-03 18:54:58 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:54:58 - src.translator.claude_client - INFO - üîÑ STREAMING CLAUDE API REQUEST
2026-01-03 18:54:58 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:54:58 - src.translator.claude_client - INFO - üìä Document details:
2026-01-03 18:54:58 - src.translator.claude_client - INFO -   - Document length: 457 characters
2026-01-03 18:54:58 - src.translator.claude_client - INFO -   - Source: de -> Target: it
2026-01-03 18:54:58 - src.translator.claude_client - INFO -   - Glossary matches: 1
2026-01-03 18:54:58 - src.translator.claude_client - INFO -   - Memory hits: 0
2026-01-03 18:54:58 - src.translator.claude_client - INFO -   - Reference doc pairs: 0
2026-01-03 18:54:58 - src.translator.claude_client - INFO - üìè Prompt details:
2026-01-03 18:54:58 - src.translator.claude_client - INFO -   - Total prompt length: 997 characters (~249 tokens)
2026-01-03 18:54:58 - src.translator.claude_client - INFO - üéØ Model: claude-sonnet-4-5-20250929
2026-01-03 18:54:58 - src.translator.claude_client - INFO - ‚è±Ô∏è  Starting streaming translation...
2026-01-03 18:54:58 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:55:00 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2026-01-03 18:55:00 - src.translator.api - INFO - [STREAM 52f3a583-d7cc-4256-b6b8-725b72d938ce] Starting streaming translation
2026-01-03 18:55:00 - src.translator.processing - INFO - [_read_file_as_text] Reading entire file as text: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp1yjvcp8y.pdf
2026-01-03 18:55:00 - src.translator.processing - INFO - [_read_file_as_text] File type: .pdf
2026-01-03 18:55:00 - src.translator.processing - INFO - [_read_file_as_text] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:55:00 - src.translator.processing - INFO - [_read_file_as_text] File size: 187,007 bytes
2026-01-03 18:55:01 - src.translator.processing - INFO - [_read_file_as_text] Extracted text length: 457 characters
2026-01-03 18:55:01 - src.translator.processing - INFO - [_read_file_as_text] First 200 chars: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
Kontow√§hrung: EUR
Kontoinhaber: Enrico Mariotti
Buchungstag: 2024-09-06
Umsatzart: √úberweisung
Erik I...
INFO:     127.0.0.1:62751 - "GET /api/translate/streaming/status HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62750 - "POST /api/translate-stream HTTP/1.1" 200 OK
2026-01-03 18:55:01 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:55:01 - src.translator.claude_client - INFO - üîÑ STREAMING CLAUDE API REQUEST
2026-01-03 18:55:01 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:55:01 - src.translator.claude_client - INFO - üìä Document details:
2026-01-03 18:55:01 - src.translator.claude_client - INFO -   - Document length: 457 characters
2026-01-03 18:55:01 - src.translator.claude_client - INFO -   - Source: de -> Target: it
2026-01-03 18:55:01 - src.translator.claude_client - INFO -   - Glossary matches: 1
2026-01-03 18:55:01 - src.translator.claude_client - INFO -   - Memory hits: 0
2026-01-03 18:55:01 - src.translator.claude_client - INFO -   - Reference doc pairs: 0
2026-01-03 18:55:01 - src.translator.claude_client - INFO - üìè Prompt details:
2026-01-03 18:55:01 - src.translator.claude_client - INFO -   - Total prompt length: 997 characters (~249 tokens)
2026-01-03 18:55:01 - src.translator.claude_client - INFO - üéØ Model: claude-sonnet-4-5-20250929
2026-01-03 18:55:01 - src.translator.claude_client - INFO - ‚è±Ô∏è  Starting streaming translation...
2026-01-03 18:55:01 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:55:03 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2026-01-03 18:55:06 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:55:06 - src.translator.claude_client - INFO - ‚úÖ CLAUDE API STREAMING COMPLETED
2026-01-03 18:55:06 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:55:06 - src.translator.claude_client - INFO - ‚è±Ô∏è  Total duration: 7.27 seconds
2026-01-03 18:55:06 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:55:06 - src.translator.api - INFO - [STREAM 271fd657-df81-424e-b650-e885c2e1ebe9] Generating PDF...
2026-01-03 18:55:06 - src.translator.api - INFO - [STREAM 271fd657-df81-424e-b650-e885c2e1ebe9] Using PyMuPDF to preserve PDF formatting
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Translating PDF with formatting preservation
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Input: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpovc6z2m7.pdf
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Output: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpua20wg6g.pdf
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Number of translated paragraphs: 2
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Reading PDF: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpovc6z2m7.pdf
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpovc6z2m7.pdf
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File size: 187,007 bytes
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] PDF opened, pages: 1
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] First page first chunk: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
K...
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Extracted 1 paragraphs
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Extracted 1 original paragraphs from PDF
2026-01-03 18:55:06 - src.translator.pdf_formatter - WARNING - Paragraph count mismatch: 1 original vs 2 translated
2026-01-03 18:55:06 - src.translator.pdf_formatter - WARNING - Will attempt to map paragraphs by position
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Opened PDF with 1 pages
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Processing page 1
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Found 11 paragraph groups
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Starting with translation_idx=0, total translations=2
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Redacting all text spans to remove original text
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Will replace 2 paragraphs with translations
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: No more translations available, stopping at paragraph 2
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Re-inserting 2 translated paragraphs
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 0: '# Traduzione in italiano...' (font: Arial, size: 14.0)
2026-01-03 18:55:06 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-7.8), trying insert_text
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 1: '## Dettagli della transazione
www.commerzbank.de
I...' (font: Arial Bold, size: 7.5)
2026-01-03 18:55:06 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-148.0), trying insert_text
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Saved translated PDF with preserved formatting to /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpua20wg6g.pdf
2026-01-03 18:55:06 - src.translator.api - INFO - [STREAM 271fd657-df81-424e-b650-e885c2e1ebe9] PDF generated with formatting preservation: 199,677 bytes
2026-01-03 18:55:06 - src.translator.api - INFO - [STREAM 271fd657-df81-424e-b650-e885c2e1ebe9] PDF stored for download
2026-01-03 18:55:06 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:55:06 - src.translator.claude_client - INFO - ‚úÖ CLAUDE API STREAMING COMPLETED
2026-01-03 18:55:06 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:55:06 - src.translator.claude_client - INFO - ‚è±Ô∏è  Total duration: 5.33 seconds
2026-01-03 18:55:06 - src.translator.claude_client - INFO - ================================================================================
2026-01-03 18:55:06 - src.translator.api - INFO - [STREAM 52f3a583-d7cc-4256-b6b8-725b72d938ce] Generating PDF...
2026-01-03 18:55:06 - src.translator.api - INFO - [STREAM 52f3a583-d7cc-4256-b6b8-725b72d938ce] Using PyMuPDF to preserve PDF formatting
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Translating PDF with formatting preservation
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Input: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp1yjvcp8y.pdf
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Output: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpk6yqp0pw.pdf
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Number of translated paragraphs: 2
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Reading PDF: /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp1yjvcp8y.pdf
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Absolute path: /private/var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmp1yjvcp8y.pdf
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File hash: 5d8bac2b5f3b93e3a8a4d7373852e903
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] File size: 187,007 bytes
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] PDF opened, pages: 1
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] First page first chunk: Umsatzdetails
www.commerzbank.de
IBAN: DE49 1008 0000 0272 7699 00 | 0-Euro-Konto
BIC: DRESDEFF100
K...
2026-01-03 18:55:06 - src.translator.pdf_io - INFO - [read_paragraphs_from_pdf] Extracted 1 paragraphs
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Extracted 1 original paragraphs from PDF
2026-01-03 18:55:06 - src.translator.pdf_formatter - WARNING - Paragraph count mismatch: 1 original vs 2 translated
2026-01-03 18:55:06 - src.translator.pdf_formatter - WARNING - Will attempt to map paragraphs by position
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Opened PDF with 1 pages
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Processing page 1
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Found 11 paragraph groups
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Starting with translation_idx=0, total translations=2
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Redacting all text spans to remove original text
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Will replace 2 paragraphs with translations
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: No more translations available, stopping at paragraph 2
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Re-inserting 2 translated paragraphs
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 0: '# Traduzione in italiano...' (font: Arial, size: 14.0)
2026-01-03 18:55:06 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-7.8), trying insert_text
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Inserting translation 1: '## Dettagli della transazione
www.commerzbank.de
I...' (font: Arial Bold, size: 7.5)
2026-01-03 18:55:06 - src.translator.pdf_formatter - WARNING - Page 1: insert_textbox overflow (rc=-148.0), trying insert_text
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Page 1: Successfully inserted text using insert_text
2026-01-03 18:55:06 - src.translator.pdf_formatter - INFO - Saved translated PDF with preserved formatting to /var/folders/w7/wsfvt7nd4y96pfgcf0_9x2_h0000gp/T/tmpk6yqp0pw.pdf
2026-01-03 18:55:06 - src.translator.api - INFO - [STREAM 52f3a583-d7cc-4256-b6b8-725b72d938ce] PDF generated with formatting preservation: 199,677 bytes
2026-01-03 18:55:06 - src.translator.api - INFO - [STREAM 52f3a583-d7cc-4256-b6b8-725b72d938ce] PDF stored for download
INFO:     127.0.0.1:62761 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
INFO:     127.0.0.1:62763 - "GET /api/glossary/glossary/content HTTP/1.1" 200 OK
2026-01-03 18:55:23 - src.translator.api - INFO - [DOWNLOAD STREAM 52f3a583-d7cc-4256-b6b8-725b72d938ce] Serving PDF from memory: 199,677 bytes
INFO:     127.0.0.1:62781 - "GET /api/translate-stream/52f3a583-d7cc-4256-b6b8-725b72d938ce/download HTTP/1.1" 200 OK
rom memory: 199,677 bytes
